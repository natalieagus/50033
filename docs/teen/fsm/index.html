<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-teen/fsm" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Finite State Machine | Game Development and Design</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://natalieagus.github.io/50033/docs/teen/fsm"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Finite State Machine | Game Development and Design"><meta data-rh="true" name="description" content="A pluggable state machine implemented as a ScriptableObject in Unity is a powerful way to create flexible and reusable state-based logic for your game objects. It allows you to define custom data structures and behaviors that can be shared across multiple game objects."><meta data-rh="true" property="og:description" content="A pluggable state machine implemented as a ScriptableObject in Unity is a powerful way to create flexible and reusable state-based logic for your game objects. It allows you to define custom data structures and behaviors that can be shared across multiple game objects."><link data-rh="true" rel="icon" href="/50033/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://natalieagus.github.io/50033/docs/teen/fsm"><link data-rh="true" rel="alternate" href="https://natalieagus.github.io/50033/docs/teen/fsm" hreflang="en"><link data-rh="true" rel="alternate" href="https://natalieagus.github.io/50033/docs/teen/fsm" hreflang="x-default"><script src="https://cdn.jsdelivr.net/npm/brython@3.9.5/brython.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/brython@3.9.5/brython_stdlib.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/50033/assets/css/styles.9cdf0fa5.css">
<script src="/50033/assets/js/runtime~main.37e27f95.js" defer="defer"></script>
<script src="/50033/assets/js/main.9b58041b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/50033/img/home-logo.svg"><link rel="preload" as="image" href="/50033/assets/images/mario-fsm.png-3bc86b37a4d616a92eda99d2dad1631f.png"><link rel="preload" as="image" href="/50033/assets/images/mario-fsm-buffs-d0af36603b4c35c5b73f66ed87b9e63f.png"><link rel="preload" as="image" href="/50033/assets/images/mario-fsm-6c2b94b9794fdfa0d4d3b8b8ea2ef1cb.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-11-52-06-83d465969a273b2a686248f598959f2e.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-11-59-51-713a52a9139f2510ded0e5a059397f03.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-01-12-f8e5b60fddadb4f44d21e7334a1688d2.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-13-17-38-2bb35826b826841856bb196488dd7a97.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-13-16-25-7818f46ead94d6c9f4947130f472adcf.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-08-51-517f9150d93babda1e85aad23ed23fad.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-09-38-d122d698c365e6210082b73b8e545b2a.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-11-28-1f0d9b31280d8a7711375f1acc56a249.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-16-50-aeb2267aea21dc147c50b0ed2ffb9742.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-34-17-d30ee62b638a8568d5a0a29fee192023.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-48-46-a6ec0ce035722feee4714ff57a0ee9a6.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-42-23-c48c0c1e0fe656b0f99e7baf3906f63b.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-12-58-05-eed4419e0febc99951e9676ded069946.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-13-05-52-01d19de8e387a429213d11aa63f6fa95.png"><link rel="preload" as="image" href="/50033/assets/images/2023-10-03-13-07-14-c893bcf510cfed99b0bf1ee2b80c7bf9.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_jvwV"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/50033/"><div class="navbar__logo"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">50.033</b></a><a class="navbar__item navbar__link" href="/50033/about/intro">About</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/50033/docs/syllabus">Lab Docs</a><a class="navbar__item navbar__link" href="/50033/resources/category/general-resources">Resources</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_H2mL"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/natalieagus/50033" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_RSuS"><div class="sidebarViewport_pYEE"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/50033/"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>50.033</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/50033/docs/syllabus">Syllabus</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/50033/docs/category/unity-for-newborns">Unity for Newborns</a><button aria-label="Expand sidebar category &#x27;Unity for Newborns&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/50033/docs/category/unity-for-babies">Unity for Babies</a><button aria-label="Expand sidebar category &#x27;Unity for Babies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/50033/docs/category/unity-for-toddlers">Unity for Toddlers</a><button aria-label="Expand sidebar category &#x27;Unity for Toddlers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/50033/docs/category/unity-for-children">Unity for Children</a><button aria-label="Expand sidebar category &#x27;Unity for Children&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/50033/docs/category/unity-for-teens">Unity for Teens</a><button aria-label="Collapse sidebar category &#x27;Unity for Teens&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/docs/teen/scriptobjgamearch">ScriptableObject Game Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/50033/docs/teen/fsm">Finite State Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/docs/teen/checkoff">Checkoff</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/50033/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/50033/docs/category/unity-for-teens"><span itemprop="name">Unity for Teens</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Finite State Machine</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Finite State Machine</h1></header>
<p>A pluggable state machine implemented as a ScriptableObject in Unity is a <strong>powerful</strong> way to create <span class="orange-bold">flexible</span> and <span class="orange-bold">reusable</span> state-based logic for your game objects. It allows you to define custom data structures and behaviors that can be <strong>shared</strong> across multiple game objects.</p>
<p>We begin by creating a State, Action, and Transition SO. The State SO describes a list of <strong>actions</strong> that have to be done in that state, and takes in a list of <strong>transitions</strong> to determine the next state that we can go to. Then we need to create a StateMachineController to be attached to the GameObject we want to control with the state machine. In this part of the lab, we will create a simple FSM to control Mario&#x27;s state upon receiving different types of Powerups and Buffs. There will be <span class="orange-bold">two</span> FSMs: one that will control Mario&#x27;s regular state (appearance), and another one to control its Buffs.</p>
<p>We will follow the this basic idea for Mario&#x27;s state:</p>
<section><img src="/50033/assets/images/mario-fsm.png-3bc86b37a4d616a92eda99d2dad1631f.png" class="center_image_tcFY , invert-color" style="width:50%"></section>
<p>As for Buffs, we have this simple construct:</p>
<section><img src="/50033/assets/images/mario-fsm-buffs-d0af36603b4c35c5b73f66ed87b9e63f.png" class="center_image_tcFY , invert-color" style="width:30%"></section>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-pluggable-fsm-architecture">The Pluggable FSM Architecture<a href="#the-pluggable-fsm-architecture" class="hash-link" aria-label="Direct link to The Pluggable FSM Architecture" title="Direct link to The Pluggable FSM Architecture">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="state">State<a href="#state" class="hash-link" aria-label="Direct link to State" title="Direct link to State">​</a></h3>
<!-- -->
<br>
<p>A <code>state</code> inherits SO, and is implemented as follows:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">State.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;PluggableSM/State&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">ScriptableObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">[</span><span class="token class-name punctuation" style="color:#6c6783">]</span><span class="token plain"> setupActions</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">[</span><span class="token class-name punctuation" style="color:#6c6783">]</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">EventAction</span><span class="token class-name punctuation" style="color:#6c6783">[</span><span class="token class-name punctuation" style="color:#6c6783">]</span><span class="token plain"> eventTriggeredActions</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">[</span><span class="token class-name punctuation" style="color:#6c6783">]</span><span class="token plain"> exitActions</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Transition</span><span class="token class-name punctuation" style="color:#6c6783">[</span><span class="token class-name punctuation" style="color:#6c6783">]</span><span class="token plain"> transitions</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// for visualisation at the Scene</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Color</span><span class="token plain"> sceneGizmoColor </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">grey</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/********************************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/* REGULAR METHODS */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// these regular methods cannot be overriden</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">UpdateState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">DoActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">CheckTransitions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">protected</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">DoActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">DoSetupActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> setupActions</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> setupActions</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">DoExitActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> exitActions</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> exitActions</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">DoEventTriggeredActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">ActionType</span><span class="token plain"> type </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> ActionType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Default</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// cast all actions that matches given type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">EventAction</span><span class="token plain"> eventTriggeredAction </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> eventTriggeredActions</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">eventTriggeredAction</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">type </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> type</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                eventTriggeredAction</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">action</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">protected</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CheckTransitions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        controller</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">transitionStateChanged </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">//reset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> transitions</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">++</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">//check if the previous transition has caused a change. If yes, stop. Let Update() in StateController run again in the next state.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">transitionStateChanged</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">break</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> decisionSucceded </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> transitions</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">decision</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Decide</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">decisionSucceded</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                controller</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TransitionToState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">transitions</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">trueState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                controller</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TransitionToState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">transitions</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">falseState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/********************************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It mainly contains <span class="orange-bold">regular methods</span> (cannot be overriden) with the following functionality:</p>
<ol>
<li><code>UpdateState</code>: called at every frame update by the state controller, we cast our actions and check for possible transitions</li>
<li>Action-related methods: there are <span class="orange-bold">four</span> types of actions:<!-- -->
<ul>
<li><strong>Exit</strong> and <strong>Setup</strong> Actions: to be done exactly <strong>once</strong>: when we first arrive at this state and when we <em>leave</em> this state</li>
<li><strong>Actions</strong>: called at <strong>every frame update</strong> by <code>UpdateState</code>. This is particularly useful if you have bots or NPCs, but not so much in the case of player-controlled Mario</li>
<li><strong>Event</strong> Triggered Actions: actions that should be executed whenever the controller wishes to cast it, could be due to certain events such as keyboard pressed or collision with other gameObjects</li>
</ul>
</li>
<li><code>CheckTransitions</code>: goes through every single transition listed under <code>transitions</code>. Some decision resulted in a different state, while some results in the same state. If the gameObject has changed its state, we <code>break</code> (stop checking for more transitions)</li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="action">Action<a href="#action" class="hash-link" aria-label="Direct link to Action" title="Direct link to Action">​</a></h3>
<!-- -->
<p>An <code>Action</code> class also inherits SO. The exact implementation of each action differs depending on the action, and so we leave its method as <code>abstract</code>:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">Action.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">Action</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">ScriptableObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">abstract</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="eventaction">EventAction<a href="#eventaction" class="hash-link" aria-label="Direct link to EventAction" title="Direct link to EventAction">​</a></h3>
<p>An <code>EventAction</code> is simply a <code>struct</code> containing an <code>Action</code> and its type. This is to allow the <code>State</code> to loop through each registered <code>EventAction</code> and cast an <code>Action</code> whose <code>Type</code> matches the user-defined type accordingly should a particular event occur:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">EventAction.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token class-name">ActionType</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Attack </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Default </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token number" style="color:#e09142">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">System</span><span class="token attribute class-name punctuation" style="color:#6c6783">.</span><span class="token attribute class-name">Serializable</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token class-name">EventAction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Action</span><span class="token plain"> action</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">ActionType</span><span class="token plain"> type</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="decision">Decision<a href="#decision" class="hash-link" aria-label="Direct link to Decision" title="Direct link to Decision">​</a></h3>
<!-- -->
<p>A <code>Decision</code> class also inherits SO, and similarly we declare its method as <code>abstract</code> first since its implementation varies greatly:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">Decision.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">Decision</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">ScriptableObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">abstract</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Decide</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="transition">Transition<a href="#transition" class="hash-link" aria-label="Direct link to Transition" title="Direct link to Transition">​</a></h3>
<p>A <code>Transition</code> is simply a <code>struct</code> to hold a <code>Decision</code>, and two <code>State</code> depending on whether that decision returns <code>true</code> or <code>false</code>:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">Transition.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">System</span><span class="token attribute class-name punctuation" style="color:#6c6783">.</span><span class="token attribute class-name">Serializable</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">Transition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Decision</span><span class="token plain"> decision</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> trueState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> falseState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="state-controller">State Controller<a href="#state-controller" class="hash-link" aria-label="Direct link to State Controller" title="Direct link to State Controller">​</a></h3>
<p>This script should be attached to the game object you wished to be the state machine. You can use it to manage buffs and powerups for your main character or to control NPCs or AI bots.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">StateController.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">StateController</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">MonoBehaviour</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> startState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> previousState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> currentState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> remainState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> transitionStateChanged </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">HideInInspector</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> stateTimeElapsed</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> isActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">virtual</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Start</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">OnSetupState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// setup when game starts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">virtual</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnSetupState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">currentState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            currentState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">DoSetupActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">virtual</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnExitState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// reset time in this state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        stateTimeElapsed </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">currentState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            currentState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">DoExitActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// for visual aid to indicate which state this object is currently at</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">virtual</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnDrawGizmos</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">currentState </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Gizmos</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">color </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> currentState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">sceneGizmoColor</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            Gizmos</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">DrawWireSphere</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1.0f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/********************************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Regular methods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// no action should be done here, strictly for transition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">TransitionToState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">State</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">nextState </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> remainState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// The following two methods only happens once if nextState != remainstate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">OnExitState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// cast exit action if any,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// transition the states</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        previousState </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> currentState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        currentState </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        transitionStateChanged </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">OnSetupState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// cast entry action if any</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// default method to check if we&#x27;ve been in the state long enough</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// this method assumes that you will call this once per update frame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Time.deltaTime: the interval in seconds from the last frame to the current one (Read Only).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CheckIfCountDownElapsed</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> duration</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        stateTimeElapsed </span><span class="token operator" style="color:#e09142">+=</span><span class="token plain"> Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">deltaTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> stateTimeElapsed </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> duration</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Update</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">isActive</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// this is different from gameObject active, allow for separate control</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        currentState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">UpdateState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/********************************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-caution alert alert--warning admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>important</div><div class="admonitionContent_vXIg"><p>You will need to inherit the <code>StateController</code> to suit your own needs. There are three regular methods that you should not modify, and for virtual methods which you can <code>override</code>. Dont forget to call <code>base.[method]()</code> if you want to invoke the parent&#x27;s implementation as well. Take your time to read how things work in <code>StateController</code>.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-mario-state-controller">Create Mario State Controller<a href="#create-mario-state-controller" class="hash-link" aria-label="Direct link to Create Mario State Controller" title="Direct link to Create Mario State Controller">​</a></h2>
<p><code>MarioStateController</code> is a script that we will attach to Mario to control its powerup effect. You can extend this class however you like, but we shall start by inheriting the base class <code>StateController</code>:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">MarioStateController.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">MarioStateController</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">StateController</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">PowerupType</span><span class="token plain"> currentPowerupType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> PowerupType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Default</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">MarioState</span><span class="token plain"> shouldBeNextState </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> MarioState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Default</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Start</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">base</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Start</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">GameRestart</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// clear powerup in the beginning, go to start state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// this should be added to the GameRestart EventListener as callback</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">GameRestart</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// clear powerup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        currentPowerupType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> PowerupType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Default</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// set the start state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">TransitionToState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">startState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SetPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">PowerupType</span><span class="token plain"> i</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        currentPowerupType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>MarioState Enum</div><div class="admonitionContent_vXIg"><p>To make life easier, we use an <code>Enum</code> to define <code>MarioState</code>:</p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">MarioState.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token class-name">MarioState</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Default </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    SmallMario </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    SuperMario </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    FireMario </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">2</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    InvincibleSmallMario </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">3</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    DeadMario </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">99</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-action-scripts">Create Action Scripts<a href="#create-action-scripts" class="hash-link" aria-label="Direct link to Create Action Scripts" title="Direct link to Create Action Scripts">​</a></h2>
<p>Since <code>Action</code> and <code>Decision</code> are highly specific to our use cases, we need to create scripts that describe <em>what</em> we should do. Let&#x27;s start with <strong>actions</strong> first, there are three categories of actions from this FSM diagram we had above:</p>
<section><img src="/50033/assets/images/mario-fsm-6c2b94b9794fdfa0d4d3b8b8ea2ef1cb.png" class="center_image_tcFY , invert-color" style="width:50%"></section>
<ol>
<li>Regular Action: <code>FireAttackAction</code></li>
<li>Setup Action: <code>SetupAnimatorAction</code>, <code>ClearPowerupAction</code>, <code>InvincibleAction</code></li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="setupanimatoraction">SetupAnimatorAction<a href="#setupanimatoraction" class="hash-link" aria-label="Direct link to SetupAnimatorAction" title="Direct link to SetupAnimatorAction">​</a></h3>
<p>This script swaps Mario&#x27;s current animator to be the other. It will only be done <strong>once</strong>, for example when entering SuperMario state, or when entering FireMario state. This entirely changes how Mario looks:</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/week-5/change-animator.mp4" type="video/mp4">Your browser does not support the video tag.</video></div>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">SetupAnimatorAction.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;PluggableSM/Actions/SetupAnimator&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">SetupAnimator</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">Action</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">RuntimeAnimatorController</span><span class="token plain"> animatorController</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        controller</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">gameObject</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">Animator</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">runtimeAnimatorController </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> animatorController</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The method <code>Act</code> receives a <code>StateController</code> parameter, which you can use to access the <code>gameObject</code> it is attached to and access its components using <code>GetComponent</code>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="clearpowerupaction">ClearPowerupAction<a href="#clearpowerupaction" class="hash-link" aria-label="Direct link to ClearPowerupAction" title="Direct link to ClearPowerupAction">​</a></h3>
<p>This action <strong>removes</strong> the current powerup registered as member in MarioState controller.</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ClearPowerupAAction.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;PluggableSM/Actions/ClearPowerup&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ClearPowerupAction</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">Action</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">MarioStateController</span><span class="token plain"> m </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">MarioStateController</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        m</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentPowerupType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> PowerupType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Default</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Since the method <code>Act</code> accepts <code>StateController</code> parameter, we need to <span class="orange-bold">cast</span> it to <code>MarioStateController</code> first before being able to access the member <code>currentPowerupType</code>.</p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>PowerupType Enum</div><div class="admonitionContent_vXIg"><p>To make life easier, we use an <code>Enum</code> to define our <code>PowerupType</code>. Use this to label each <code>Powerup</code> present in the game.</p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">PowerupType.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token class-name">PowerupType</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Coin </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    MagicMushroom </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    OneUpMushroom </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">2</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    StarMan </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">3</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    FireFlower </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">4</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Damage </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">99</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Default </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token number" style="color:#e09142">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><span class="orange-bold">Note how <code>Damage</code> is some kind of &quot;PowerupType&quot; too. You will need to make further modifications to make this work</span>.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fireattackaction">FireAttackAction<a href="#fireattackaction" class="hash-link" aria-label="Direct link to FireAttackAction" title="Direct link to FireAttackAction">​</a></h3>
<p>This action is called whenever the key &#x27;Z&#x27; is pressed and whenever Mario is at FireMario state as follows:</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/week-5/fireball.mp4" type="video/mp4">Your browser does not support the video tag.</video></div>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">FireAttackAction.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;PluggableSM/Actions/FireAttack&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">FireAttackAction</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">Action</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> maxPrefabInScene </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">3</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> impulseForce </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> degree </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">45</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">GameObject</span><span class="token plain"> attackPrefab</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// a scriptable object updated by PlayerMovement / PlayerController to store current Mario&#x27;s facing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">BoolVariable</span><span class="token plain"> marioFaceRight</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">GameObject</span><span class="token class-name punctuation" style="color:#6c6783">[</span><span class="token class-name punctuation" style="color:#6c6783">]</span><span class="token plain"> instantiatedPrefabsInScene </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> GameObject</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">FindGameObjectsWithTag</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">attackPrefab</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">tag</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">instantiatedPrefabsInScene</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Length </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> maxPrefabInScene</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// instantiate it where controller (mario) is</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name">GameObject</span><span class="token plain"> x </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Instantiate</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">attackPrefab</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> Quaternion</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">identity</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// Get the Rigidbody component of the instantiated object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name">Rigidbody2D</span><span class="token plain"> rb </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">Rigidbody2D</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// Check if the Rigidbody component exists</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">rb </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token comment" style="color:#6c6783">// compute direction vector</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token class-name">Vector2</span><span class="token plain"> direction </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CalculateDirection</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">degree</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> marioFaceRight</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token comment" style="color:#6c6783">// Apply a rightward impulse force to the object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                rb</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">AddForce</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">direction </span><span class="token operator" style="color:#e09142">*</span><span class="token plain"> impulseForce</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> ForceMode2D</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Impulse</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">Vector2</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CalculateDirection</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> degrees</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> isFacingRight</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Convert degrees to radians</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> radians </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> degrees </span><span class="token operator" style="color:#e09142">*</span><span class="token plain"> Mathf</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Deg2Rad</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Calculate the direction vector</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> x </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Mathf</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Cos</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">radians</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> y </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Mathf</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Sin</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">radians</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// If the object is facing left, invert the x-component of the direction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">isFacingRight</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            x </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token plain">x</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When <code>Act</code> is called, we instantiate a prefab <code>attackPrefab</code> and spawn it based on the direction that Mario is facing, 45 degrees upwards with an initial impulseForce. We added some little constraint to prevent spamming of this prefab by limiting only 3 prefabs on the scene at a time.</p>
<details class="details_lb9f alert alert--info details_b_Ee collapsible_hOX2" data-collapsed="true"><summary mdxtype="summary" style="font-weight:bold">Fireball Prefab</summary><div><div class="collapsibleContent_i85q"><p>You are free to create your own custom fireball prefab, but here&#x27;s how we implement it with a Coroutine so that it only lasts for about 2.5 seconds and destroys itself when colliding with Enemy:</p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">FireballController.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Threading</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Tasks</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">FireballController</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">MonoBehaviour</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Start is called before the first frame update</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">SerializeField</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> scaleSpeed </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1.0f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Start</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">StartCoroutine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token function" style="color:#9a86fd">ScaleAndDestroyCoroutine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">AudioSource</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Play</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name">IEnumerator</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ScaleAndDestroyCoroutine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Wait for 2 seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">yield</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">WaitForSecondsRealtime</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token number" style="color:#e09142">2</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Gradually scale down the GameObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">transform</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">localScale</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">x </span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.01f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            transform</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">localScale </span><span class="token operator" style="color:#e09142">-=</span><span class="token plain"> Vector3</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">one </span><span class="token operator" style="color:#e09142">*</span><span class="token plain"> scaleSpeed </span><span class="token operator" style="color:#e09142">*</span><span class="token plain"> Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">deltaTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">yield</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Ensure the GameObject is completely scaled down</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        transform</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">localScale </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Vector3</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">zero</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Destroy the GameObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">Destroy</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">gameObject</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnCollisionEnter2D</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">Collision2D</span><span class="token plain"> collision</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">collision</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">gameObject</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">tag </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;Enemy&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// destroy self</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">Destroy</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">gameObject</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To create the prefab, simply add the following components and attach the script above to it:</p><section><img src="/50033/assets/images/2023-10-03-11-52-06-83d465969a273b2a686248f598959f2e.png" class="center_image_tcFY" style="width:100%"></section></div></div></details>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="invincibleaction">InvincibleAction<a href="#invincibleaction" class="hash-link" aria-label="Direct link to InvincibleAction" title="Direct link to InvincibleAction">​</a></h3>
<p>This action happens when SuperMario or FireMario collides with Goomba. We need to rapidly enable and disable Mario&#x27;s SpriteRenderer (flicker) until Mario&#x27;s state is no longer <code>InvincibleSmallMario</code>. Since <code>InvincibleAction</code> is a ScriptableObject, we cannot utilise Coroutines. As such the actual <strong>implementation</strong> of Mario&#x27;s flickering sprite should be implemented within <code>MarioStateController</code>. The <code>InvincibleAction</code> simply <span class="orange-bold">calls</span> that method.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">InvincibleAction.cs</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">MarioStateController.cs</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;PluggableSM/Actions/SetupInvincibility&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">InvincibleAction</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">Action</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">AudioClip</span><span class="token plain"> invincibilityStart</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Act</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">MarioStateController</span><span class="token plain"> m </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">MarioStateController</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        m</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">gameObject</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">AudioSource</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">PlayOneShot</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">invincibilityStart</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        m</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetRendererToFlicker</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">MarioStateController</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">StateController</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">SpriteRenderer</span><span class="token plain"> spriteRenderer</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// other methods</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SetRendererToFlicker</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        spriteRenderer </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">SpriteRenderer</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">StartCoroutine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token function" style="color:#9a86fd">BlinkSpriteRenderer</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name">IEnumerator</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">BlinkSpriteRenderer</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        spriteRenderer </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">SpriteRenderer</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">string</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Equals</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">currentState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;InvincibleSmallMario&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> StringComparison</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">OrdinalIgnoreCase</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// Toggle the visibility of the sprite renderer</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">            spriteRenderer</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">enabled </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">spriteRenderer</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">enabled</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// Wait for the specified blink interval</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">yield</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">WaitForSeconds</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">gameConstants</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">flickerInterval</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        spriteRenderer</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">enabled </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-action-scriptable-objects">Create Action Scriptable Objects<a href="#create-action-scriptable-objects" class="hash-link" aria-label="Direct link to Create Action Scriptable Objects" title="Direct link to Create Action Scriptable Objects">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="setupanimatoraction-1">SetupAnimatorAction<a href="#setupanimatoraction-1" class="hash-link" aria-label="Direct link to SetupAnimatorAction" title="Direct link to SetupAnimatorAction">​</a></h3>
<p>We now <strong>instantiate</strong> these actions accordingly. Right click at the Project window and select <code>SetupAnimator</code> Action:</p>
<section><img src="/50033/assets/images/2023-10-03-11-59-51-713a52a9139f2510ded0e5a059397f03.png" class="center_image_tcFY" style="width:100%"></section>
<p>Name it <code>SetupSmallMario</code>, and attach <code>Mario</code> animator in the Animator Controller field:</p>
<section><img src="/50033/assets/images/2023-10-03-12-01-12-f8e5b60fddadb4f44d21e7334a1688d2.png" class="center_image_tcFY" style="width:100%"></section>
<p>Now you need to create DeadMario, SuperMario and FireMario Animators as well, and then create three more <code>SetupAnimator</code> Action, name it <code>SetupDeadMario</code>, <code>SetupSuperMario</code> and <code>SetupFireMario</code>. Here&#x27;s a preview of the animators required:</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/week-5/setup-more-animators.mp4" type="video/mp4">Your browser does not support the video tag.</video></div>
<details class="details_lb9f alert alert--info details_b_Ee collapsible_hOX2" data-collapsed="true"><summary mdxtype="summary" style="font-weight:bold">Animation Event on Animators not Attached to gameObject</summary><div><div class="collapsibleContent_i85q"><p>Note that if you want to call an Animation Event from <code>mario-die</code> animation clip, you can attach it to Mario first and set up necessary functions as per normal from such function dropdown at the <span class="orange-bold">inspector</span>:</p><section><img src="/50033/assets/images/2023-10-03-13-17-38-2bb35826b826841856bb196488dd7a97.png" class="center_image_tcFY" style="width:100%"></section><p>When you switch Mario&#x27;s animator to other animator, DeadMario animator and clips becomes standalone (not associated with any object). The event will work just fine, but notice how they&#x27;re matched based on name:</p><section><img src="/50033/assets/images/2023-10-03-13-16-25-7818f46ead94d6c9f4947130f472adcf.png" class="center_image_tcFY" style="width:100%"></section><p>Hence next time you attach DeadMario as Mario&#x27;s animator, it will find a function called <code>PlayDeathImpulse</code> in any of Mario&#x27;s attached script.</p></div></div></details>
<p>By now you should have four setup actions: <code>SetupSmallMario</code>, <code>SetupSuperMario</code>, <code>SetupFireMario</code>, and <code>SetupDeadMario</code>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="clearpowerupaction-1">ClearPowerupAction<a href="#clearpowerupaction-1" class="hash-link" aria-label="Direct link to ClearPowerupAction" title="Direct link to ClearPowerupAction">​</a></h3>
<p>There&#x27;s nothing to set up for this action, simply instantiate it and name it <code>ClearPowerup</code>:</p>
<section><img src="/50033/assets/images/2023-10-03-12-08-51-517f9150d93babda1e85aad23ed23fad.png" class="center_image_tcFY" style="width:100%"></section>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fireattackaction-1">FireAttackAction<a href="#fireattackaction-1" class="hash-link" aria-label="Direct link to FireAttackAction" title="Direct link to FireAttackAction">​</a></h3>
<p>Create this action and name it <code>FireAttackAction</code>, link up the necessary values in the inspector:</p>
<section><img src="/50033/assets/images/2023-10-03-12-09-38-d122d698c365e6210082b73b8e545b2a.png" class="center_image_tcFY" style="width:100%"></section>
<details class="details_lb9f alert alert--info details_b_Ee collapsible_hOX2" data-collapsed="true"><summary mdxtype="summary" style="font-weight:bold">BoolVariable</summary><div><div class="collapsibleContent_i85q"><p>Although not explicitly stated, you should know that <code>BoolVariable</code> is a scriptable object containing a boolean value:</p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">BoolVariable.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">fileName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;BoolVariable&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">,</span><span class="token attribute attribute-arguments"> menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;ScriptableObjects/BoolVariable&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">,</span><span class="token attribute attribute-arguments"> order </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments number" style="color:#e09142">2</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">BoolVariable</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">Variable</span><span class="token type-list class-name punctuation" style="color:#6c6783">&lt;</span><span class="token type-list class-name keyword" style="color:#ffcc99">bool</span><span class="token type-list class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SetValue</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        _value </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// overload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SetValue</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">BoolVariable</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">SetValue</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Toggle</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        _value </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">_value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We instantiate it and named it <code>MarioFaceRight</code>:</p><section><img src="/50033/assets/images/2023-10-03-12-11-28-1f0d9b31280d8a7711375f1acc56a249.png" class="center_image_tcFY" style="width:100%"></section><p>Then we manipulate its value in <code>PlayerController.cs</code>:</p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">PlayerController.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">PlayerControllerWeek5</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">MonoBehaviour</span><span class="token type-list punctuation" style="color:#6c6783">,</span><span class="token type-list"> </span><span class="token type-list class-name">IPowerupApplicable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">BoolVariable</span><span class="token plain"> marioFaceRight</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">FlipMarioSprite</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">value</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token number" style="color:#e09142">1</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> faceRightState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">updateMarioShouldFaceRight</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            marioSprite</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">flipX </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">faceRightState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">marioBody</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">linearVelocity</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">x </span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.05f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                marioAnimator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetTrigger</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;onSkid&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">else</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">value</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">faceRightState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">updateMarioShouldFaceRight</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            marioSprite</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">flipX </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">faceRightState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">marioBody</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">linearVelocity</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">x </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token number" style="color:#e09142">0.05f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                marioAnimator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetTrigger</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;onSkid&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">updateMarioShouldFaceRight</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        faceRightState </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        marioFaceRight</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetValue</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">faceRightState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This way we can know whether to cast the fireball to the right or to the left depending on Mario&#x27;s current facing.</p></div></div></details>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="invincibleaction-1">InvincibleAction<a href="#invincibleaction-1" class="hash-link" aria-label="Direct link to InvincibleAction" title="Direct link to InvincibleAction">​</a></h3>
<p>For this action, there&#x27;s nothing much you need to do except to instantiate it and give it the desired Audio Clip to play when this action starts:</p>
<section><img src="/50033/assets/images/2023-10-03-12-16-50-aeb2267aea21dc147c50b0ed2ffb9742.png" class="center_image_tcFY" style="width:100%"></section>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-decision-scripts">Create Decision Scripts<a href="#create-decision-scripts" class="hash-link" aria-label="Direct link to Create Decision Scripts" title="Direct link to Create Decision Scripts">​</a></h2>
<p>These scripts inherit the <code>Decision</code> class, and must implement one method <code>Decide</code> which returns a boolean value.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="transformdecision">TransformDecision<a href="#transformdecision" class="hash-link" aria-label="Direct link to TransformDecision" title="Direct link to TransformDecision">​</a></h3>
<p>This decision determines whether we should transform into another state given the current state and the current powerup:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">TransformDecision.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;PluggableSM/Decisions/Transform&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">TransformDecision</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">Decision</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">StateTransformMap</span><span class="token class-name punctuation" style="color:#6c6783">[</span><span class="token class-name punctuation" style="color:#6c6783">]</span><span class="token plain"> map</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Decide</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">MarioStateController</span><span class="token plain"> m </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">MarioStateController</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain">controller</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// we assume that the state is named (string matched) after one of possible values in MarioState</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// convert between current state name into MarioState enum value using custom class EnumExtension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// you are free to modify this to your own use</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">MarioState</span><span class="token plain"> toCompareState </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> EnumExtension</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token generic-method function" style="color:#9a86fd">ParseEnum</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">MarioState</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// loop through state transform and see if it matches the current transformation we are looking for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> map</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">toCompareState </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> map</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">fromState </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> m</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentPowerupType </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> map</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">powerupCollected</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">System</span><span class="token attribute class-name punctuation" style="color:#6c6783">.</span><span class="token attribute class-name">Serializable</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token class-name">StateTransformMap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">MarioState</span><span class="token plain"> fromState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">PowerupType</span><span class="token plain"> powerupCollected</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee collapsible_hOX2" data-collapsed="true"><summary mdxtype="summary" style="font-weight:bold">EnumExtension.cs</summary><div><div class="collapsibleContent_i85q"><p>This is a custom class to easily convert between the string or integer representation of an enum to the enum:</p><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">EnumExtension.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">static</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">EnumExtension</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">static</span><span class="token plain"> </span><span class="token return-type class-name">T</span><span class="token plain"> </span><span class="token generic-method function" style="color:#9a86fd">ParseEnum</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">T</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">where</span><span class="token plain"> </span><span class="token class-name">T</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list keyword" style="color:#ffcc99">struct</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// return the enum value given a string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">T</span><span class="token plain"> enumValue</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">Enum</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TryParse</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">input</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">out</span><span class="token plain"> enumValue</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> enumValue</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">default</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token type-expression class-name">T</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> </span><span class="token generic-method function" style="color:#9a86fd">ParseEnumToInteger</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">T</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">where</span><span class="token plain"> </span><span class="token class-name">T</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list keyword" style="color:#ffcc99">struct</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// return the integer enum given a string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">T</span><span class="token plain"> enumValue </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token generic-method function" style="color:#9a86fd">ParseEnum</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">T</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">Enum</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">IsDefined</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">typeof</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token type-expression class-name">T</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> enumValue</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> Convert</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ToInt32</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">enumValue</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-</span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="countdowndecision">CountdownDecision<a href="#countdowndecision" class="hash-link" aria-label="Direct link to CountdownDecision" title="Direct link to CountdownDecision">​</a></h3>
<p>Another decision that we can create is to detect if we have been in the current state longer than a stipulated duration by calling the state controller&#x27;s <code>CheckIfCountdownElapsed</code> regular method:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">CountdownDecision.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;PluggableSM/Decisions/Countdown&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">CountdownDecision</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">Decision</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> buffDuration</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Decide</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">StateController</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> controller</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">CheckIfCountDownElapsed</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">buffDuration</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-decision-scriptable-objects">Create Decision Scriptable Objects<a href="#create-decision-scriptable-objects" class="hash-link" aria-label="Direct link to Create Decision Scriptable Objects" title="Direct link to Create Decision Scriptable Objects">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="transform-decision">Transform Decision<a href="#transform-decision" class="hash-link" aria-label="Direct link to Transform Decision" title="Direct link to Transform Decision">​</a></h3>
<p>We have several decisions that we have to make depending on which MarioState we want to transform to:</p>
<ol>
<li><code>ShouldTransformToSuperMario</code></li>
<li><code>ShouldTransformToFireMario</code></li>
<li><code>ShouldTransformToDeadMario</code></li>
<li><code>ShouldTransformToInvincibleMario</code></li>
</ol>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/week-5/should-transform.mp4" type="video/mp4">Your browser does not support the video tag.</video></div>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>How Transform Decision Works</div><div class="admonitionContent_vXIg"><p>We create various Transform Decision SO and hard-code the decision we are looking for in that instance:</p><ul>
<li>The idea is that the method <code>Decide</code> will return <code>true</code> if current state and powerup matches what&#x27;s described in the <code>Decision</code>.</li>
<li>For example, <code>ShouldTransformToSuperMario</code> has one of its <code>Map</code> element <code>fromState</code> value set to <code>SmallMario</code> and <code>powerupCollected</code> value value set to <code>MagicMushroom</code>.</li>
<li>Hence, if the controller&#x27;s current state name is <code>SmallMario</code> and current Powerup collected is <code>Magic Mushroom</code>, then <code>ShouldTransformToSuperMario</code> should return <code>true</code></li>
</ul></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="countdown-decision">Countdown Decision<a href="#countdown-decision" class="hash-link" aria-label="Direct link to Countdown Decision" title="Direct link to Countdown Decision">​</a></h3>
<p>The countdown decision is fairly straightforward, you are free to set the value of <code>buffDuration</code>:</p>
<section><img src="/50033/assets/images/2023-10-03-12-34-17-d30ee62b638a8568d5a0a29fee192023.png" class="center_image_tcFY" style="width:100%"></section>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="create-state-scriptable-objects">Create State Scriptable Objects<a href="#create-state-scriptable-objects" class="hash-link" aria-label="Direct link to Create State Scriptable Objects" title="Direct link to Create State Scriptable Objects">​</a></h2>
<p>Now that we have all our actions and decisions ready, it is time to create the states. As per the fsm diagram, we need <strong>five</strong> states:</p>
<ol>
<li><code>DeadMario</code></li>
<li><code>FireMario</code></li>
<li><code>InvincibleSmallMario</code></li>
<li><code>SmallMario</code></li>
<li><code>SuperMario</code></li>
</ol>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="remaininstate">RemainInState<a href="#remaininstate" class="hash-link" aria-label="Direct link to RemainInState" title="Direct link to RemainInState">​</a></h3>
<p>We need a &quot;dummy&quot; state to indicate that we <span class="orange-bold">remain in state</span>. Create this dummy state first and leave the inspector empty:</p>
<section><img src="/50033/assets/images/2023-10-03-12-48-46-a6ec0ce035722feee4714ff57a0ee9a6.png" class="center_image_tcFY" style="width:100%"></section>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="mario-states">Mario States<a href="#mario-states" class="hash-link" aria-label="Direct link to Mario States" title="Direct link to Mario States">​</a></h3>
<p>Now create five more state instances and name them accordingly. You will then need to modify its members in the inspector. Here&#x27;s the specs of <code>FireMario</code>:</p>
<ol>
<li>There exist <strong>two</strong> setup actions: setup fire mario animator and clear the powerup in <code>MarioStateController</code></li>
<li>There exist also one event-triggered action: <code>FireAttack</code> of <code>ActionType.Attack</code> (enum defined in <code>EventAction.cs</code>). It will not be called every frame, but rather only when <code>Z</code> key is pressed. <span class="orange-bold">We will explicitly call this later in <code>MarioStateController</code></span>.</li>
<li>There&#x27;s also only one transition to consider: which determines whether it should go to <code>InvincibleSmallMario</code> state or <code>RemainInState</code> (our dummy state).</li>
</ol>
<section><img src="/50033/assets/images/2023-10-03-12-42-23-c48c0c1e0fe656b0f99e7baf3906f63b.png" class="center_image_tcFY" style="width:100%"></section>
<p>Recall that in <code>StateController.cs</code>, we keep track of <code>RemainState</code> State. This is useful for detecting whether we transition between different states or stay in the same state.</p>
<blockquote>
<p>Of course you may skip this functionality and use some name matching to check if <code>currentState.name == previousState.name</code> to determine whether you state has transitioned, but plain old string matching isn&#x27;t fun 🥹.</p>
</blockquote>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">abstract</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">StateController</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">MonoBehaviour</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> startState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> previousState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> currentState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token plain"> remainState</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">TransitionToState</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">State</span><span class="token plain"> nextState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">nextState </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> remainState</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// other instructions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// other methods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="update-mariostatecontroller-to-trigger-eventaction">Update MarioStateController to Trigger EventAction<a href="#update-mariostatecontroller-to-trigger-eventaction" class="hash-link" aria-label="Direct link to Update MarioStateController to Trigger EventAction" title="Direct link to Update MarioStateController to Trigger EventAction">​</a></h2>
<p>The last thing that we need to do is to update our <code>MarioStateController</code> script to launch <code>FireAttack</code> when key &#x27;Z&#x27; is pressed. Add a new public void method called <code>Fire</code>:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">MarioStateController.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Fire</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">DoEventTriggeredActions</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> ActionType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Attack</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will calls the <code>Act</code> method of <span class="orange-bold">all</span> registered event-triggered actions in this state whose <code>type</code> matches <code>ActionType.Attack</code>. You should link up this method to whatever <code>ActionManager</code> script which sanitises the input from Input System.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="attach-mariostatecontroller-to-mario">Attach MarioStateController to Mario<a href="#attach-mariostatecontroller-to-mario" class="hash-link" aria-label="Direct link to Attach MarioStateController to Mario" title="Direct link to Attach MarioStateController to Mario">​</a></h2>
<p>The final step is to attach <code>MarioStateController</code> script to Mario:</p>
<ul>
<li>Set its <code>StartState</code> to <code>SmallMario</code></li>
<li>Set <code>RemainState</code> as <code>RemainInState</code> (our dummy state)</li>
<li>If you utilise <code>GameConstants</code>, you need to link it up here</li>
</ul>
<section><img src="/50033/assets/images/2023-10-03-12-58-05-eed4419e0febc99951e9676ded069946.png" class="center_image_tcFY" style="width:100%"></section>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="modify-how-damage-works">Modify how &quot;Damage&quot; Works<a href="#modify-how-damage-works" class="hash-link" aria-label="Direct link to Modify how &quot;Damage&quot; Works" title="Direct link to Modify how &quot;Damage&quot; Works">​</a></h3>
<p>When Mario collides with Goomba, there has to be a way for us to set <code>MarioStateController</code>&#x27;s current powerup member to <code>PowerupType.Damage</code>. One suggested way is to modify your existing &quot;damage player&quot; callback in <code>PlayerController</code>:</p>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">PlayerController.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">DamageMario</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// GameOverAnimationStart(); // last time Mario dies right away</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// pass this to StateController to see if Mario should start game over</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// since both state StateController and MarioStateController are on the same gameobject, it&#x27;s ok to cross-refer between scripts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">MarioStateController</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">PowerupType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Damage</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We assume the above is the callback you use when listening to <code>OnPlayerDamaged</code> event:</p>
<section><img src="/50033/assets/images/2023-10-03-13-05-52-01d19de8e387a429213d11aa63f6fa95.png" class="center_image_tcFY" style="width:60%"></section>
<p>The <code>Update()</code> method of <code>MarioStateController</code> will always re-run the Decisions registered under <code>SmallMario</code> state at each frame:</p>
<section><img src="/50033/assets/images/2023-10-03-13-07-14-c893bcf510cfed99b0bf1ee2b80c7bf9.png" class="center_image_tcFY" style="width:100%"></section>
<p>As a result, the moment we collide with Goomba whilst in <code>SmallMario</code> state will trigger MarioStateController to switch Mario&#x27;s state into <code>DeadMario</code>, and the default animation clip on <code>DeadMario</code> will play (which calles <code>PlayDeathImpulse</code> and <code>GameOverScene</code> methods in Mario&#x27;s scripts respectively):</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/week-5/mario-damaged-fsm.mp4" type="video/mp4">Your browser does not support the video tag.</video></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="modify-how-powerup-works">Modify how Powerup Works<a href="#modify-how-powerup-works" class="hash-link" aria-label="Direct link to Modify how Powerup Works" title="Direct link to Modify how Powerup Works">​</a></h3>
<p>Each powerup script needs to set MarioStateController&#x27;s <code>currentPowerupType</code> whenever a powerup is collected. If you have been following the lab closely, you can modify the <code>ApplyPowerup</code> method in each class inheriting <code>BasePowerup</code> class as follows:</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">MagicMushroomPowerup.cs</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">FireFlowerPowerup.cs</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ApplyPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">MonoBehaviour</span><span class="token plain"> i</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">base</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ApplyPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// try</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">MarioStateController</span><span class="token plain"> mario</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> result </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token generic-method function" style="color:#9a86fd">TryGetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">MarioStateController</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">out</span><span class="token plain"> mario</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            mario</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">powerupType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">override</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ApplyPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">MonoBehaviour</span><span class="token plain"> i</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">base</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ApplyPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// try</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">MarioStateController</span><span class="token plain"> mario</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> result </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token generic-method function" style="color:#9a86fd">TryGetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">MarioStateController</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">out</span><span class="token plain"> mario</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            mario</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetPowerup</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">powerupType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<div class="theme-admonition theme-admonition-playtest alert alert--playtest admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 122.88 122.88"><path d="M61.44 0c33.93 0 61.44 27.51 61.44 61.44s-27.51 61.44-61.44 61.44S0 95.37 0 61.44 27.51 0 61.44 0m23.47 65.52c3.41-2.2 3.41-4.66 0-6.61L49.63 38.63c-2.78-1.75-5.69-.72-5.61 2.92l.11 40.98c.24 3.94 2.49 5.02 5.8 3.19z" style="fill-rule:evenodd;clip-rule:evenodd"></path></svg></span>test</div><div class="admonitionContent_vXIg"><p>Changing MarioStateController&#x27;s <code>currentPowerupType</code> member will trigger state transition depending on its <code>currentState</code>. When small Mario obtains the magic mushroom, he transforms to super Mario. If he is damaged by Goomba, he will enter invincible small Mario state where he can&#x27;t be damaged by Goombas.</p><div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/week-5/supermario.mp4" type="video/mp4">Your browser does not support the video tag.</video></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/50033/docs/teen/scriptobjgamearch"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ScriptableObject Game Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/50033/docs/teen/checkoff"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Checkoff</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-pluggable-fsm-architecture" class="table-of-contents__link toc-highlight">The Pluggable FSM Architecture</a><ul><li><a href="#state" class="table-of-contents__link toc-highlight">State</a></li><li><a href="#action" class="table-of-contents__link toc-highlight">Action</a></li><li><a href="#eventaction" class="table-of-contents__link toc-highlight">EventAction</a></li><li><a href="#decision" class="table-of-contents__link toc-highlight">Decision</a></li><li><a href="#transition" class="table-of-contents__link toc-highlight">Transition</a></li><li><a href="#state-controller" class="table-of-contents__link toc-highlight">State Controller</a></li></ul></li><li><a href="#create-mario-state-controller" class="table-of-contents__link toc-highlight">Create Mario State Controller</a></li><li><a href="#create-action-scripts" class="table-of-contents__link toc-highlight">Create Action Scripts</a><ul><li><a href="#setupanimatoraction" class="table-of-contents__link toc-highlight">SetupAnimatorAction</a></li><li><a href="#clearpowerupaction" class="table-of-contents__link toc-highlight">ClearPowerupAction</a></li><li><a href="#fireattackaction" class="table-of-contents__link toc-highlight">FireAttackAction</a></li><li><a href="#invincibleaction" class="table-of-contents__link toc-highlight">InvincibleAction</a></li></ul></li><li><a href="#create-action-scriptable-objects" class="table-of-contents__link toc-highlight">Create Action Scriptable Objects</a><ul><li><a href="#setupanimatoraction-1" class="table-of-contents__link toc-highlight">SetupAnimatorAction</a></li><li><a href="#clearpowerupaction-1" class="table-of-contents__link toc-highlight">ClearPowerupAction</a></li><li><a href="#fireattackaction-1" class="table-of-contents__link toc-highlight">FireAttackAction</a></li><li><a href="#invincibleaction-1" class="table-of-contents__link toc-highlight">InvincibleAction</a></li></ul></li><li><a href="#create-decision-scripts" class="table-of-contents__link toc-highlight">Create Decision Scripts</a><ul><li><a href="#transformdecision" class="table-of-contents__link toc-highlight">TransformDecision</a></li><li><a href="#countdowndecision" class="table-of-contents__link toc-highlight">CountdownDecision</a></li></ul></li><li><a href="#create-decision-scriptable-objects" class="table-of-contents__link toc-highlight">Create Decision Scriptable Objects</a><ul><li><a href="#transform-decision" class="table-of-contents__link toc-highlight">Transform Decision</a></li><li><a href="#countdown-decision" class="table-of-contents__link toc-highlight">Countdown Decision</a></li></ul></li><li><a href="#create-state-scriptable-objects" class="table-of-contents__link toc-highlight">Create State Scriptable Objects</a><ul><li><a href="#remaininstate" class="table-of-contents__link toc-highlight">RemainInState</a></li><li><a href="#mario-states" class="table-of-contents__link toc-highlight">Mario States</a></li></ul></li><li><a href="#update-mariostatecontroller-to-trigger-eventaction" class="table-of-contents__link toc-highlight">Update MarioStateController to Trigger EventAction</a></li><li><a href="#attach-mariostatecontroller-to-mario" class="table-of-contents__link toc-highlight">Attach MarioStateController to Mario</a><ul><li><a href="#modify-how-damage-works" class="table-of-contents__link toc-highlight">Modify how &quot;Damage&quot; Works</a></li><li><a href="#modify-how-powerup-works" class="table-of-contents__link toc-highlight">Modify how Powerup Works</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 50.033 Game Design and Development</div></div></div></footer></div>
</body>
</html>