<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-resources docs-version-current docs-doc-page docs-doc-id-general/combo" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Combo System | Game Development and Design</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://natalieagus.github.io/50033/resources/general/combo"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-resources-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-resources-current"><meta data-rh="true" property="og:title" content="Combo System | Game Development and Design"><meta data-rh="true" name="description" content="Modern action games use combo systems to transform simple button presses into expressive and skillful combat sequences. These systems define how attacks connect, how player inputs are interpreted, and how timing affects responsiveness. Over the years, developers have explored many different philosophies for designing combos, each shaping the rhythm and style of combat in distinctive ways."><meta data-rh="true" property="og:description" content="Modern action games use combo systems to transform simple button presses into expressive and skillful combat sequences. These systems define how attacks connect, how player inputs are interpreted, and how timing affects responsiveness. Over the years, developers have explored many different philosophies for designing combos, each shaping the rhythm and style of combat in distinctive ways."><link data-rh="true" rel="icon" href="/50033/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://natalieagus.github.io/50033/resources/general/combo"><link data-rh="true" rel="alternate" href="https://natalieagus.github.io/50033/resources/general/combo" hreflang="en"><link data-rh="true" rel="alternate" href="https://natalieagus.github.io/50033/resources/general/combo" hreflang="x-default"><script src="https://cdn.jsdelivr.net/npm/brython@3.9.5/brython.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/brython@3.9.5/brython_stdlib.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/50033/assets/css/styles.9cdf0fa5.css">
<script src="/50033/assets/js/runtime~main.901f5a4d.js" defer="defer"></script>
<script src="/50033/assets/js/main.f08ea8f3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/50033/img/home-logo.svg"><link rel="preload" as="image" href="/50033/assets/images/2025-10-09-16-42-07-7b857bc16a9a3e52303a865a1844e2e2.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-10-08-05-3e31f15795c535fbd3aa9f12e40abe6c.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-10-08-22-075fa62f9560d66cdfdf1ea32286795e.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-09-16-42-49-36659484b747e6ca20d4e41e06cc6768.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-09-16-47-53-0d1b6fa9ede1622d6cb6eaef4b283ab9.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-10-23-49-814873c94fc7784514e6703a4e0ca91a.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-10-25-24-a6c6f55a6c5f3f30ca7e37af897ae9a5.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-09-36-14-c962e9fa462fa0856d6e4244673c454d.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-09-39-12-9cae4d187748d63f09425be31b4277fb.png"><link rel="preload" as="image" href="/50033/assets/images/Screenshot 2025-10-10 at 10.12.53 AM-58e96b6e1f7a7f7460ef6a32dca5b8df.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-09-40-11-f0125427d1619f064161df4bb79b053d.png"><link rel="preload" as="image" href="/50033/assets/images/2025-10-10-09-38-06-eb5b473478f8ec16116ac5b554f1e44f.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_jvwV"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/50033/"><div class="navbar__logo"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">50.033</b></a><a class="navbar__item navbar__link" href="/50033/about/intro">About</a><a class="navbar__item navbar__link" href="/50033/docs/syllabus">Lab Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/50033/resources/category/general-resources">Resources</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_H2mL"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/natalieagus/50033" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_RSuS"><div class="sidebarViewport_pYEE"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/50033/"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/50033/img/home-logo.svg" alt="DDW Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>50.033</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/50033/resources/category/general-resources">General Resources</a><button aria-label="Collapse sidebar category &#x27;General Resources&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/uidb">The Game UI Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/tilemap">Tilemap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/prog-pattern">Game Programming Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/assets-db">Asset Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/cheats">God Mode for Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/helper-buttons">Creating Helper Buttons in Inspector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/patterns">Diving into Unity Architecture Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/sprite-resolver">Using Sprite Resolver With Sprite Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/object-pooling">Object Pooling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/data-driven-stats">Data-Driven Player Stats Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/50033/resources/general/combo">Combo System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/hybrid-arch">Hybrid Service-Adapter Architecture with ScriptableObjects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/50033/resources/general/bootstrap">Bootstrapping</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/50033/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/50033/resources/category/general-resources"><span itemprop="name">General Resources</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Combo System</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Combo System</h1></header>
<p>Modern action games use combo systems to transform simple button presses into expressive and skillful combat sequences. These systems define how attacks <strong>connect</strong>, how player inputs are interpreted, and how timing affects <strong>responsiveness</strong>. Over the years, developers have explored many different philosophies for designing combos, each shaping the rhythm and style of combat in distinctive ways.</p>
<p>In games like <em>God of War</em> or <em>Nier: Automata</em>, combos are typically built around a <span class="orange-bold">chain</span>-based structure. Each button press leads naturally to the next animation, forming a rhythmic sequence that feels powerful and cinematic. These systems prioritize accessibility and flow. The player doesn’t need to memorize complex inputs, only to sense the right timing. In contrast, games such as <em>Devil May Cry</em> or <em>Bayonetta</em> elevate player expression by allowing <span class="orange-bold">cancels and branching</span> patterns. Attacks can be interrupted mid-animation or chained into other moves depending on frame timing, producing a fluid, improvisational style that rewards mechanical mastery.</p>
<p><strong>Competitive</strong> fighting games like <em>Street Fighter</em> or <em>Tekken</em> take a different approach: combos there are <span class="orange-bold">input-pattern-driven</span>. The focus is on precision and memorization, where every motion and button press sequence must be executed with near-perfect timing <strong>to link attacks successfully</strong>. Meanwhile, tactical action titles like <em>Monster Hunter</em> or <em>Nioh</em> integrate stance-based or weapon-specific combos, where each weapon has its own rules and timing rhythm. In these games, combos are <em>slower</em> but highly deliberate. Success depends on managing stamina, distance, and commitment.</p>
<p>The combo system implemented here takes inspiration from several of these design philosophies.</p>
<ul>
<li>Structurally, it resembles <em>God of War</em>’s readable <strong>chain-based approach</strong>, but internally, it is built to support <strong>flexible branching and timing rules</strong> more akin to <em>Bayonetta</em> or <em>Devil May Cry</em>.</li>
<li>It is <strong>data-driven</strong>, meaning designers define attacks, chains, and timings entirely through <code>ScriptableObjects</code> rather than code.
The system dynamically interprets player input in real time, matching button sequences against a library of combo patterns and deciding whether to start a new chain, advance an existing one, or trigger a finisher.</li>
</ul>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>The System&#x27;s Philosophy</div><div class="admonitionContent_vXIg"><p>This proposed approach creates a clear separation between <strong>data</strong> and <strong>logic</strong>.</p><p>Each combo is a piece of data: a configuration of steps, windows, and animation triggers—while the runtime system handles resolution, timing, and feedback. The result is a modular and scalable design where new weapons or fighting styles can be added without modifying code, only by creating new data assets. In practice, this allows the same engine to support everything from a simple three-hit sword combo to a complex branching martial arts system.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="prerequisite">Prerequisite<a href="#prerequisite" class="hash-link" aria-label="Direct link to Prerequisite" title="Direct link to Prerequisite">​</a></h3>
<p>This system relies on <a href="/50033/resources/general/data-driven-stats">Data-Driven Player Stats architecture</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="architecture-overview">Architecture Overview<a href="#architecture-overview" class="hash-link" aria-label="Direct link to Architecture Overview" title="Direct link to Architecture Overview">​</a></h2>
<p>A combo system may appear simple: “press attack three times to chain hits” but under the hood, it’s an intricate network of <em>timing</em>, <em>state</em>, and data <em>interpretation</em>. The architecture here separates those concerns cleanly so that combat logic remains readable, extensible, and designer-friendly (can be tuned to improve feel via inspector without touching code).</p>
<p>At its core, this system follows a three-layer architecture:</p>
<table><thead><tr><th>Layer</th><th>Purpose</th><th>Example Classes</th></tr></thead><tbody><tr><td><strong>Data Layer</strong></td><td>Stores designer-defined information about attacks, stamina, and combo sequences.</td><td><code>AttackData</code>, <code>ComboStep</code>, <code>ComboChain</code>, <code>CombatConfig</code></td></tr><tr><td><strong>Runtime Layer</strong></td><td>Handles moment-to-moment logic: input processing, timing, animation, and execution.</td><td><code>ComboManager</code>, <code>ComboExecutor</code>, <code>ComboResolver</code>, <code>CooldownManager</code>, <code>FinisherEvaluator</code></td></tr><tr><td><strong>State Layer</strong></td><td>Tracks what’s currently happening such as active combos, queued attacks, current timing windows.</td><td><code>ComboState</code>, <code>ComboTiming</code>, <code>ActiveCombo</code></td></tr></tbody></table>
<p>Each layer interacts through well-defined data boundaries. The runtime <span class="orange-bold">never</span> directly <span class="orange-bold">hardcodes</span> what an attack does; it merely reads from the data layer and updates the state layer accordingly. This makes the entire combat system data-driven, testable, and non-destructive. We can iterate on weapon design without recompiling code.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="high-level-class-composition">High Level Class Composition<a href="#high-level-class-composition" class="hash-link" aria-label="Direct link to High Level Class Composition" title="Direct link to High Level Class Composition">​</a></h3>
<!-- -->
<p>Design Intent:</p>
<ol>
<li><strong>No subclassing</strong>: None of these types inherit from one another. Each one represents a distinct role in the combat pipeline.</li>
<li><strong>Single-responsibility</strong>: Each class owns a single concept, such as resolution, execution, timing, etc. This means you can test them individually or replace implementations (e.g. swap ComboResolver for one that supports branching).</li>
<li><strong>Runtime composition</strong>: The <code>ComboManager</code> instantiates and wires all of them. It doesn’t override behavior through inheritance; it <span class="orange-bold">delegates</span>.</li>
</ol>
<p>It has the following composition hierarchy:</p>
<table><thead><tr><th>Layer</th><th>Owned By</th><th>Example Responsibilities</th></tr></thead><tbody><tr><td><strong>Data</strong></td><td>Asset (ScriptableObject)</td><td>Defines what attacks exist, how long windows last, stamina costs, animation triggers.</td></tr><tr><td><strong>State</strong></td><td><code>ComboManager</code> instance</td><td>Tracks what is happening right now — active combos, pending finishers, timing.</td></tr><tr><td><strong>Runtime</strong></td><td><code>ComboManager</code> composition</td><td>Executes logic, updates state, reads data, and signals animations.</td></tr></tbody></table>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sample-combat-moveset-and-combo">Sample Combat Moveset and Combo<a href="#sample-combat-moveset-and-combo" class="hash-link" aria-label="Direct link to Sample Combat Moveset and Combo" title="Direct link to Sample Combat Moveset and Combo">​</a></h3>
<p>In order to understand how things work in an abstract level, we need to use an example. Assume we have these clips and their <code>AttackType</code> values:</p>
<table><thead><tr><th>Clip Name</th><th>Attack Type (key specific)</th><th>Description</th></tr></thead><tbody><tr><td><code>Sword_Light1</code> (basic)</td><td><code>Light1</code></td><td>First fast horizontal slash</td></tr><tr><td><code>Sword_Light2</code> (basic)</td><td><code>Light2</code></td><td>Second faster returning slash</td></tr><tr><td><code>Sword_Light3</code> (basic)</td><td><code>Light3</code></td><td>Third downward secondary slash</td></tr><tr><td><code>Sword_Light3_Ice</code> (special)</td><td><code>Light3</code></td><td>Downward secondary slash with Ice effect</td></tr><tr><td><code>Sword_Heavy1</code> (basic)</td><td><code>Heavy</code></td><td>A slower, stamina-heavy overhead strike</td></tr><tr><td><code>FireSlash_Finisher</code></td><td>--</td><td>Finisher animation for FireSlash Combo</td></tr><tr><td><code>GroundSlam_Finisher</code></td><td>--</td><td>Finisher animation for Groundslam Combo</td></tr></tbody></table>
<p>Then, suppose we have these combo chains (the clips played are the basic ones unless otherwise stated):</p>
<ul>
<li><strong>FireSlash</strong>: <code>Light1</code> → <code>Light2</code> (has finisher, hits not required)</li>
<li><strong>IceSlash</strong>: <code>Light1</code> → <code>Light2</code> → <code>Light3</code> (no finisher)</li>
<li><strong>GroundSlam</strong>: <code>Light1</code> → <code>Light1</code> → <code>Light2</code> → <code>Light3</code> → <code>Light1</code> (has finisher, all hits required)</li>
<li><strong>Single tap</strong>: Any one-step opener (e.g., just <code>Light1</code>) should also perform a valid attack (basic clip).</li>
</ul>
<p>A combo sequence can look as simple as pressing a few buttons in rhythm but internally each press moves through a strict orchestration of logic, timing, and state updates.</p>
<p>Since certain key press like <code>Light3</code> in different chains might trigger different clips, we need to decompose the chains into Combo Steps (not just key presses)</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fireslash-combo-chain">FireSlash Combo Chain<a href="#fireslash-combo-chain" class="hash-link" aria-label="Direct link to FireSlash Combo Chain" title="Direct link to FireSlash Combo Chain">​</a></h4>
<p><strong>Description:</strong> A short, 2-step chain that always triggers its finisher.
<strong>Rule:</strong> Finisher plays automatically after the second step; intermediate hits not required.</p>
<table><thead><tr><th>Step</th><th>Attack Type</th><th>Clip Played</th><th>Notes</th></tr></thead><tbody><tr><td>1</td><td><code>Light1</code></td><td><code>Sword_Light1</code></td><td>Opener horizontal slash</td></tr><tr><td>2</td><td><code>Light2</code></td><td><code>Sword_Light2</code></td><td>Returning slash; triggers Fire finisher</td></tr><tr><td>F</td><td><em>(auto)</em></td><td><code>FireSlash_Finisher</code></td><td>Finisher animation after step 2</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="iceslash-combo-chain">IceSlash Combo Chain<a href="#iceslash-combo-chain" class="hash-link" aria-label="Direct link to IceSlash Combo Chain" title="Direct link to IceSlash Combo Chain">​</a></h4>
<p><strong>Description:</strong> A 3-step sequence ending with an ice-enhanced downward strike.
<strong>Rule:</strong> No finisher; each hit must connect to progress.</p>
<table><thead><tr><th>Step</th><th>Attack Type</th><th>Clip Played</th><th>Notes</th></tr></thead><tbody><tr><td>1</td><td><code>Light1</code></td><td><code>Sword_Light1</code></td><td>Basic horizontal opener</td></tr><tr><td>2</td><td><code>Light2</code></td><td><code>Sword_Light2</code></td><td>Follow-up returning slash</td></tr><tr><td>3</td><td><code>Light3</code></td><td><code>Sword_Light3_Ice</code></td><td>Downward ice effect strike (variant of Light3)</td></tr></tbody></table>
<hr>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="groundslam-combo-chain">GroundSlam Combo Chain<a href="#groundslam-combo-chain" class="hash-link" aria-label="Direct link to GroundSlam Combo Chain" title="Direct link to GroundSlam Combo Chain">​</a></h4>
<p><strong>Description:</strong> A demanding 5-step chain with all hits required; ends in a heavy slam finisher.
<strong>Rule:</strong> Finisher only triggers if every hit connects.</p>
<table><thead><tr><th>Step</th><th>Attack Type</th><th>Clip Played</th><th>Notes</th></tr></thead><tbody><tr><td>1</td><td><code>Light1</code></td><td><code>Sword_Light1</code></td><td>Horizontal opener</td></tr><tr><td>2</td><td><code>Light1</code></td><td><code>Sword_Light1</code></td><td>Repeated opening slash</td></tr><tr><td>3</td><td><code>Light2</code></td><td><code>Sword_Light2</code></td><td>Mid combo returning slash</td></tr><tr><td>4</td><td><code>Light3</code></td><td><code>Sword_Light3</code></td><td>Downward secondary slash</td></tr><tr><td>5</td><td><code>Light1</code></td><td><code>Sword_Light1</code></td><td>Final connecting slash before finisher</td></tr><tr><td>F</td><td><em>(auto)</em></td><td><code>GroundSlam_Finisher</code></td><td>Finisher only if all 5 hits succeeded</td></tr></tbody></table>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="single-tap-fallback-chain">Single Tap (Fallback Chain)<a href="#single-tap-fallback-chain" class="hash-link" aria-label="Direct link to Single Tap (Fallback Chain)" title="Direct link to Single Tap (Fallback Chain)">​</a></h4>
<p><strong>Description:</strong> Default chain for any isolated key press.
<strong>Rule:</strong> A single-step combo that always resolves successfully the moment that Attack Type key is pressed.</p>
<table><thead><tr><th>Step</th><th>Attack Type</th><th>Clip Played</th><th>Notes</th></tr></thead><tbody><tr><td>1a</td><td><code>Light1</code></td><td><code>Sword_Light1</code></td><td>Basic slash</td></tr><tr><td>1b</td><td><code>Light2</code></td><td><code>Sword_Light2</code></td><td>Optional single second slash variant</td></tr><tr><td>1c</td><td><code>Heavy</code></td><td><code>Sword_Heavy1</code></td><td>Heavy strike variant</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Combo Step and Combo Chain</div><div class="admonitionContent_vXIg"><p>A Combo Step defines the attack data: clip to play, key press to trigger, and combo window. A Combo Chain is made of several combo steps in succession.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-big-picture-resolving-and-executing-combos">The Big Picture: Resolving and Executing Combos<a href="#the-big-picture-resolving-and-executing-combos" class="hash-link" aria-label="Direct link to The Big Picture: Resolving and Executing Combos" title="Direct link to The Big Picture: Resolving and Executing Combos">​</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-1-player-input">Step 1: Player Input<a href="#step-1-player-input" class="hash-link" aria-label="Direct link to Step 1: Player Input" title="Direct link to Step 1: Player Input">​</a></h4>
<p>A button press (<code>Light1</code>, <code>Heavy</code>, etc.) is captured and passed to <code>ComboManager</code>.
Input is read using <a href="/50033/docs/toddlers/management">Unity’s Input System</a>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-2-combo-resolution">Step 2: Combo Resolution<a href="#step-2-combo-resolution" class="hash-link" aria-label="Direct link to Step 2: Combo Resolution" title="Direct link to Step 2: Combo Resolution">​</a></h4>
<p><code>ComboResolver</code> checks <em>all</em> known combo chains and decides whether this input:</p>
<ul>
<li><strong>Starts</strong> a new combo (if no active one exists or the input matches a new opener), or</li>
<li><strong>Advances</strong> an existing combo if it matches the expected next step.</li>
</ul>
<p>If several chains share the same prefix (all begin with <code>Light1</code>), they are <span class="orange-bold">all</span> temporarily active until later inputs disambiguate.</p>
<p>The resolver should also compute the <em>best</em> chain so that only one combo step executes at a time: the completed chain is <strong>chosen</strong> when multiple are valid. If no chain is completed, then it will select the <strong>longest</strong> chain instead.</p>
<p>For example, suppose we received <code>Light1</code>. This tracks all three chains: FireSlash, IceSlash, and GroundSlam. Then <code>Light2</code> is pressed. The resolver computes that:</p>
<ul>
<li><code>Light1 → Light2</code> <strong>continues</strong> the <strong>FireSlash</strong> chain (incomplete).</li>
<li><code>Light1 → Light2</code> also <strong>continues</strong> toward <strong>IceSlash</strong> chain (incomplete).</li>
<li>However it no longer tracks the <strong>GroundSlam</strong>.</li>
<li>Creates new single-tap combo <code>Light2</code> (instantly completed)</li>
</ul>
<p>At this point, the <strong>best</strong> chain would be <code>Light2</code> (single-tap combo chain).</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-3-execution">Step 3: Execution<a href="#step-3-execution" class="hash-link" aria-label="Direct link to Step 3: Execution" title="Direct link to Step 3: Execution">​</a></h4>
<p><code>ComboExecutor</code> <strong>triggers</strong> the animation clip for the current (<em>best</em>) step, <strong>consumes</strong> stamina, <strong>applies</strong> cooldowns, and <strong>determines</strong> the next combo-window timing from either animation events or ratio settings.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-4-combo-timing-control">Step 4: Combo Timing Control<a href="#step-4-combo-timing-control" class="hash-link" aria-label="Direct link to Step 4: Combo Timing Control" title="Direct link to Step 4: Combo Timing Control">​</a></h4>
<p><code>ComboTiming</code> <span class="orange-bold">stores</span> the <code>open</code> and <code>close</code> combo timestamps for the next input window, allowing the player to <em>chain smoothly</em>.</p>
<ul>
<li>It never triggers events itself; it only exposes
<code>ShouldOpenWindow()</code> / <code>ShouldCloseWindow()</code> predicates that the <code>ComboManager</code> polls every frame.</li>
<li><span class="red-bold">Important:</span> each move’s animation clip must be <strong>longer than its combo window</strong>, so the system has time to open the window mid-animation before closing it near the end.</li>
</ul>
<p>If the player presses the next attack <strong>inside</strong> the open window, the all active combo chains <strong>advances</strong>.</p>
<p>If pressed <strong>too early or too late</strong>, the manager either <strong>buffers</strong> one queued input or <strong>drops</strong> it once the window expires.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-5-state-update">Step 5: State Update<a href="#step-5-state-update" class="hash-link" aria-label="Direct link to Step 5: State Update" title="Direct link to Step 5: State Update">​</a></h4>
<p>We need to store some kind of <code>ComboState</code> that holds the <strong>global</strong> runtime context—active chains, input history, and the currently playing combo. Therefore, once we decide the execute a combo and set up all the timings (animation clip window and combo window), we need to update our <code>ComboState</code>.</p>
<p>Recall that if several combos chains are active (e.g., <code>FireSlash</code> and <code>IceSlash</code> after <code>Light2</code>), the system keeps both but executes whichever has the <strong>deepest</strong> progress or is already <strong>complete</strong>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-6-finisher-check">Step 6: Finisher Check<a href="#step-6-finisher-check" class="hash-link" aria-label="Direct link to Step 6: Finisher Check" title="Direct link to Step 6: Finisher Check">​</a></h4>
<p>Finishers mark the completion point of a combo chain. When a chain reaches its final step, the system arms its finisher, but doesn’t play it right away.</p>
<p>Instead, the finisher is triggered <em>contextually</em>, depending on what happens next:</p>
<ol>
<li>If the player stops input, then the finisher plays naturally as the combo concludes.</li>
<li>If the next input starts a new chain (for example, pressing <code>Light3</code> after completing <code>Light1</code> → <code>Light2</code>) then the system first plays the previous combo’s finisher, then begins the <em>new</em> chain.</li>
<li>If the next input continues the same combo (e.g. <code>Light1</code> → <code>Light2</code> → <code>Light3</code> in a longer chain), then the finisher is suppressed until that longer sequence finishes.</li>
</ol>
<p>This ensures short combos still deliver their finishing payoff, while longer or branching chains remain smooth and uninterrupted. The result is a combat flow that feels responsive, readable, and cinematic as finishers punctuate the action only when a combo truly ends.</p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_vXIg"><p>If we want to add damage computation logic (AOE hits, explosions, shockwaves, etc.) for certain finishers,
the clean and scalable way is to attach that behaviour to the animation clip via events, not to the combo logic itself.</p></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-7-return-to-idle">Step 7: Return to Idle<a href="#step-7-return-to-idle" class="hash-link" aria-label="Direct link to Step 7: Return to Idle" title="Direct link to Step 7: Return to Idle">​</a></h4>
<p>If no input is queued when the animation ends, the combo state is cleared and the system returns to idle, ready for a fresh sequence.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="timing-example">Timing Example<a href="#timing-example" class="hash-link" aria-label="Direct link to Timing Example" title="Direct link to Timing Example">​</a></h3>
<p>Timing determines whether an input continues a combo or fails to register.</p>
<p>Even a perfectly defined chain (<code>Light1 → Light2 → Light3</code>) will not feel responsive unless its combo windows line up naturally with animation playback.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-anatomy-of-a-combo-step">1. Anatomy of a Combo Step<a href="#1-anatomy-of-a-combo-step" class="hash-link" aria-label="Direct link to 1. Anatomy of a Combo Step" title="Direct link to 1. Anatomy of a Combo Step">​</a></h4>
<p>Each attack animation (e.g. <code>Light1</code>) has two critical regions:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">|--------------- Animation Clip (0.0 → 1.0 normalized) ---------------|</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">^ Start: Attack Triggered                                             |</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">|              ^ Combo Window Opens                                   |</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">|                                                           ^ Combo Window Closes</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">|                                                                     ^ Animation Ends</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>The <strong>animation clip</strong> represents the full motion of a single attack.</li>
<li>The <strong>combo window</strong> is a time slice within that motion where the next input is allowed.</li>
<li>The <strong>manager</strong> uses the window timestamps (start / end) stored in <code>ComboTiming</code> to decide when to accept chaining.</li>
</ul>
<p><span class="orange-bold">Example:</span>
If the clip is 1.0 s long and the window starts at 0.45 s and ends at 0.80 s, then:</p>
<ul>
<li>Pressing the <em>next</em> input between <strong>0.45 s–0.80 s</strong> <span class="orange-bold">continues</span> the combo.</li>
<li>Pressing before 0.45 s buffers one input (queued).</li>
<li>Pressing after 0.80 s is ignored (the window closed).</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-animation-length-vs-combo-window">2. Animation Length vs Combo Window<a href="#2-animation-length-vs-combo-window" class="hash-link" aria-label="Direct link to 2. Animation Length vs Combo Window" title="Direct link to 2. Animation Length vs Combo Window">​</a></h4>
<p>It is assumed that the <strong>animation clip length must always be longer than the combo window</strong> for that step.
This ensures the window opens <strong>while</strong> the move is still visible and playable.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">Correct:</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">|---------------------- Clip (1.0s) ----------------------|</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         |------ Combo Window (0.45–0.80s) ------|</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Incorrect:</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">|----- Clip (0.5s) -----|</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      |------ Combo Window (0.45–0.80s) ------| exceeds clip length</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Designer Tips</div><div class="admonitionContent_vXIg"><p>When designing new moves, always adjust the window so that it fits comfortably <em>within</em> the visible attack animation.
If the window opens too early or closes too late, the system will either never open it or fail to chain correctly.</p></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-example-timeline-light-1--light-2--light-3-iceslash">3. Example Timeline: <code>Light 1</code> → <code>Light 2</code> → <code>Light 3</code> (“IceSlash”)<a href="#3-example-timeline-light-1--light-2--light-3-iceslash" class="hash-link" aria-label="Direct link to 3-example-timeline-light-1--light-2--light-3-iceslash" title="Direct link to 3-example-timeline-light-1--light-2--light-3-iceslash">​</a></h4>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Combo Chain: IceSlash</div><div class="admonitionContent_vXIg"><p>This combo chain is consisted of 3 combo steps:</p><ul>
<li>Step 1: Light1 input, Sword_Light1 clip</li>
<li>Step 2: Light2 input, Sword_Light2 clip</li>
<li>Step 3: Light3 input, Sword_Light3_Ice clip</li>
</ul></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">Time (s)   0.0      0.4      0.8     1.2     1.6     2.0</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        |--------|---------|-------|-------|-------|</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">         ⮕ Input: Light1 accepted</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light1   ▶ [Animation Sword_Light1]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">              [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                        ⮕ Input: Light2 accepted</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light2                             ▶ [Animation Sword_Light2]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                        [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                             ⮕ Input: Light3 accepted</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light3                                                       ▶ [Animation Sword_Light3_Ice]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                    [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                            ⮕ Finisher triggered if any (after Light 3 animation ends)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_vXIg"><p>Each animation plays <span class="orange-bold">fully</span>, with its own embedded window.</p></div></div>
<p>The player presses at the rhythm of the combo window opening. If any input misses its combo window, the chain breaks and the manager resets state.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-multiple-active-chains--longest-match-vs-completed">4. Multiple Active Chains &amp; “Longest Match” vs “Completed”<a href="#4-multiple-active-chains--longest-match-vs-completed" class="hash-link" aria-label="Direct link to 4. Multiple Active Chains &amp; “Longest Match” vs “Completed”" title="Direct link to 4. Multiple Active Chains &amp; “Longest Match” vs “Completed”">​</a></h4>
<p>During execution, several combos can remain active at once. For example, after pressing <code>Light2</code>, both <code>FireSlash</code> and <code>IceSlash</code> may still be valid continuations.</p>
<p>The resolver keeps <span class="orange-bold">all</span> active possibilities alive until input or timing disambiguates them. When the next input arrives, or when the current combo window closes, it determines the <strong>best chain</strong> to advance or finish.</p>
<p>Priority follows two rules:</p>
<ol>
<li>
<p><strong>If a chain can still advance (combo window open):</strong>
Pick the chain with the <strong>longest valid progress</strong> (deepest index).
This lets complex combos naturally override simpler ones that share prefixes.</p>
</li>
<li>
<p><strong>If the combo window closes (no further input can advance):</strong>
If one or more active chains have reached their <strong>final step</strong>, the system picks that chain and triggers its <strong>finisher</strong>.
If no chain can continue, but a new input begins a <em>different</em> chain (a new opener), then the <strong>previous finished chain’s finisher</strong> triggers <em>first</em>, immediately followed by the new chain’s opener.</p>
</li>
</ol>
<p>This timing rule ensures finishers are not fired prematurely, only when the system is certain no more valid continuation exists for the current combo.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5-finisher-timing">5. Finisher Timing<a href="#5-finisher-timing" class="hash-link" aria-label="Direct link to 5. Finisher Timing" title="Direct link to 5. Finisher Timing">​</a></h4>
<p>A finisher is evaluated <strong>when the combo window closes</strong>, signalling that no further continuation is possible.</p>
<p>If the next input after this point starts a <em>new</em> chain rather than extending the current one,
the finisher for the old chain plays <strong>first</strong>, and then the new opener executes.</p>
<p>This gives clean transitions and <span class="orange-bold">prevents</span> double-triggering.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6-visual-recap">6. Visual Recap<a href="#6-visual-recap" class="hash-link" aria-label="Direct link to 6. Visual Recap" title="Direct link to 6. Visual Recap">​</a></h4>
<!-- -->
<br>
<blockquote>
<p><strong>Design takeaway:</strong>
A finisher doesn’t just mark “combo completed”, it marks <span class="orange-bold">“combo no longer extendable.”</span> It’s only triggered once the system knows the current sequence has ended, either naturally or because the next input belongs to a new chain.</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="system-composition-and-code-structure">System Composition and Code Structure<a href="#system-composition-and-code-structure" class="hash-link" aria-label="Direct link to System Composition and Code Structure" title="Direct link to System Composition and Code Structure">​</a></h2>
<div class="theme-admonition theme-admonition-success alert alert--success admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Composition Over Inheritance</div><div class="admonitionContent_vXIg"><p>The goal here is not inheritance, but composition. Each subsystem performs one job, and the ComboManager composes them together at runtime. Composition over inheritance keeps logic modular, testable, and replaceable.</p><p>Each component is stateless or self-contained, and the manager owns them by refer</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="foundation-layer-data--stateless-components">Foundation Layer: Data &amp; Stateless Components<a href="#foundation-layer-data--stateless-components" class="hash-link" aria-label="Direct link to Foundation Layer: Data &amp; Stateless Components" title="Direct link to Foundation Layer: Data &amp; Stateless Components">​</a></h2>
<p>These are the basic data definitions and lightweight utilities. They contain <strong>no logic</strong> besides what’s necessary to store or expose information used by the runtime.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="attacktypecs"><code>AttackType.cs</code><a href="#attacktypecs" class="hash-link" aria-label="Direct link to attacktypecs" title="Direct link to attacktypecs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">AttackType.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">enum</span><span class="token plain"> </span><span class="token class-name">AttackType</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Light1</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Light2</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Light3</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    Heavy</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    None</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Simple identifier for different attacks.
Used across chains and runtime systems.</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="attackdatacs"><code>AttackData.cs</code><a href="#attackdatacs" class="hash-link" aria-label="Direct link to attackdatacs" title="Direct link to attackdatacs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">AttackData.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Defines reusable data for a single attack animation:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// stamina cost, cooldown, animation triggers, and timing overrides.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token function" style="color:#9a86fd">CreateAssetMenu</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">fileName </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;NewAttackData&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> menuName </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;Combat/Attack Data&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">AttackData</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">ScriptableObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Animation Settings&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Animator trigger that starts this attack&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> animTrigger</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;The clip used for this attack&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">AnimationClip</span><span class="token plain"> clip</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Optional follow-up animation (e.g., finisher). Leave empty for normal attacks&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> outcomeTrigger</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Combat Stats&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Stamina consumed when performing this attack&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> staminaCost </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">10f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Delay before another attack can be triggered&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> cooldown </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.1f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Defines per-attack gameplay and animation parameters.
<a href="#preparing-the-animation-clip-and-setting-up-the-animator-fsm">Animator FSM transitions</a> must be designed to match this.
Used by <code>ComboExecutor</code>.</p>
</blockquote>
<p>This is an <code>AttackData</code> for Single Tap Light1 Combo Step:</p>
<section><img src="/50033/assets/images/2025-10-09-16-42-07-7b857bc16a9a3e52303a865a1844e2e2.png" class="center_image_tcFY" style="width:100%"></section>
<p>This is an <code>AttackData</code> for the second Combo Step in FireSlash Combo Chain (has finisher trigger):</p>
<section><img src="/50033/assets/images/2025-10-10-10-08-05-3e31f15795c535fbd3aa9f12e40abe6c.png" class="center_image_tcFY" style="width:100%"></section>
<p>This is an <code>AttackData</code> for the third Combo Step in IceSlash Combo Chain:</p>
<section><img src="/50033/assets/images/2025-10-10-10-08-22-075fa62f9560d66cdfdf1ea32286795e.png" class="center_image_tcFY" style="width:100%"></section>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combostepcs"><code>ComboStep.cs</code><a href="#combostepcs" class="hash-link" aria-label="Direct link to combostepcs" title="Direct link to combostepcs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboStep.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Represents one step in the combo chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">System</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Serializable</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ComboStep</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;The button pressed to trigger this step.&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">AttackType</span><span class="token plain"> attackType</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Attack properties: stamina, animation, timing, etc.&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">AttackData</span><span class="token plain"> attackData</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Combo Window (optional override)&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;If true, uses these values instead of animation events&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> useWindowOverride </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Range</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments number" style="color:#e09142">0f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments number" style="color:#e09142">1f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> comboWindowStart </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.45f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Range</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments number" style="color:#e09142">0f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments number" style="color:#e09142">1f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> comboWindowEnd </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.85f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Represents a single node in a combo chain.
A <code>ComboChain</code> is simply an ordered list of <code>ComboStep</code>.</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combochaincs"><code>ComboChain.cs</code><a href="#combochaincs" class="hash-link" aria-label="Direct link to combochaincs" title="Direct link to combochaincs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboChain.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Collection of combo steps that form a complete combo tree for a weapon or stance.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token function" style="color:#9a86fd">CreateAssetMenu</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">fileName </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;NewComboChain&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> menuName </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;Combat/Combo Chain&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ComboChain</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">ScriptableObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;If true, finisher requires every previous attack in this chain to land a hit.&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> chainName</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> requiresAllHits </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name">ComboStep</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> steps </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>A <code>ScriptableObject</code> defining a full combo pattern (e.g., <code>Light1 → Light2 → Light3</code>).
Designers can author multiple chains per weapon.</p>
</blockquote>
<section><img src="/50033/assets/images/2025-10-09-16-42-49-36659484b747e6ca20d4e41e06cc6768.png" class="center_image_tcFY" style="width:100%"></section>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combatconfigcs"><code>CombatConfig.cs</code><a href="#combatconfigcs" class="hash-link" aria-label="Direct link to combatconfigcs" title="Direct link to combatconfigcs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">CombatConfig.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Combat/Config/Combat Config&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">CombatConfig</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">ScriptableObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Tooltip</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Global stamina cost multiplier applied to all ComboSteps.&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> staminaCostMultiplier </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1.0f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Combo Window Defaults&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Range</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments number" style="color:#e09142">0f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments number" style="color:#e09142">1f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> defaultComboWindowStart </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.5f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Range</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments number" style="color:#e09142">0f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">,</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments number" style="color:#e09142">1f</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> defaultComboWindowEnd </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.8f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Bundles all combo chains and stats into one configuration per weapon or character.
Referenced by <code>ComboManager</code> on startup.</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="playerstatscs"><code>PlayerStats.cs</code><a href="#playerstatscs" class="hash-link" aria-label="Direct link to playerstatscs" title="Direct link to playerstatscs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">PlayerStats.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">CreateAssetMenu</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments">menuName </span><span class="token attribute attribute-arguments operator" style="color:#e09142">=</span><span class="token attribute attribute-arguments"> </span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Player/Stats/Player Stats&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">PlayerStats</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">ScriptableObject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Core&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> maxStamina </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">100f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> staminaRegenRate </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">10f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> staminaRegenDelay </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Health&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> maxHealth </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">100f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Static, fixed starting stats for Player object in the system. It is <span class="red-bold">not runtime stats</span>.</p>
</blockquote>
<section><img src="/50033/assets/images/2025-10-09-16-47-53-0d1b6fa9ede1622d6cb6eaef4b283ab9.png" class="center_image_tcFY" style="width:100%"></section>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cooldownmanagercs"><code>CooldownManager.cs</code><a href="#cooldownmanagercs" class="hash-link" aria-label="Direct link to cooldownmanagercs" title="Direct link to cooldownmanagercs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">CooldownManager.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Linq</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">CooldownManager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">Dictionary</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name">AttackType</span><span class="token class-name punctuation" style="color:#6c6783">,</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> timers </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Tick</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> dt</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> key </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> timers</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Keys</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ToList</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            timers</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">-=</span><span class="token plain"> dt</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timers</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> timers</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Remove</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">IsOnCooldown</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">AttackType</span><span class="token plain"> type</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">out</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> remaining</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timers</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TryGetValue</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">type</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">out</span><span class="token plain"> remaining</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Set</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">AttackType</span><span class="token plain"> type</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> duration</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">duration </span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> timers</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">type</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> duration</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Clear</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> timers</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Clear</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Tracks and updates cooldowns per attack.
Queried in <code>ComboManager</code> before executing a step.</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combotimingcs"><code>ComboTiming.cs</code><a href="#combotimingcs" class="hash-link" aria-label="Direct link to combotimingcs" title="Direct link to combotimingcs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboTiming.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">System</span><span class="token attribute class-name punctuation" style="color:#6c6783">.</span><span class="token attribute class-name">Serializable</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">struct</span><span class="token plain"> </span><span class="token class-name">ComboTiming</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Core timing flags</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> manualTimingControlActive</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// true if using manual window timing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> comboWindowOpen</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain">           </span><span class="token comment" style="color:#6c6783">// true while player can chain attacks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> attackInProgress</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain">          </span><span class="token comment" style="color:#6c6783">// true while attack animation is active</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">AttackType</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> queuedAttackType</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain">   </span><span class="token comment" style="color:#6c6783">// one buffered attack type, if any</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Combo window tracking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> windowStartTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> windowEndTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Semantic helpers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> HasQueue </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> queuedAttackType </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> IsIdle </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">attackInProgress </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> queuedAttackType </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Methods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Reset</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> includeQueue </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        attackInProgress </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">includeQueue</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            queuedAttackType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SetComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> start</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> end</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowStartTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> start</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowEndTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> end</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ShouldOpenWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">comboWindowOpen </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> now </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> windowStartTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ShouldCloseWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> comboWindowOpen </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> now </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> windowEndTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ClearWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowStartTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowEndTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Holds the open/close timing for chaining combo inputs and <span class="orange-bold">queued attack buffer</span> (1 queue slot only).
Polled by the manager each frame; never triggers events on its own.</p>
</blockquote>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="activecombocs"><code>ActiveCombo.cs</code><a href="#activecombocs" class="hash-link" aria-label="Direct link to activecombocs" title="Direct link to activecombocs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ActiveCombo.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Linq</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Text</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Runtime tracker for an active combo chain.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ActiveCombo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">ComboChain</span><span class="token plain"> chain </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">set</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> hasCompletedAllSteps </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">set</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> stepHits</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> _currentIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> currentIndex</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> _currentIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">set</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            _currentIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">value</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">TrySetComboCompletion</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">ComboStep</span><span class="token plain"> currentStep</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">currentIndex</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">AttackType</span><span class="token plain"> currentAttackType</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> currentStep</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ActiveCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ComboChain</span><span class="token plain"> c</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> startIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        chain </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> c</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        currentIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> startIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        stepHits </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Enumerable</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Repeat</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ToList</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">TrySetComboCompletion</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        hasCompletedAllSteps </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> _currentIndex </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count </span><span class="token operator" style="color:#e09142">-</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">RegisterHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        stepHits</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">_currentIndex</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">AllStepsHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> stepHits</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">All</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">hit </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> hit</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">DebugPrintHits</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> sb </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        sb</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">AppendLine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;[ActiveCombo Debug] Chain: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">name</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> (Steps: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">steps</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">Count</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">)&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> stepHits</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> status </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> stepHits</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">?</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;✅ HIT&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;❌ MISS&quot;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> currentMarker </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">i </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> currentIndex</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">?</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot; &lt;-- current&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;&quot;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            sb</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">AppendLine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;  Step </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">i </span><span class="token interpolation-string interpolation expression language-csharp operator" style="color:#e09142">+</span><span class="token interpolation-string interpolation expression language-csharp"> </span><span class="token interpolation-string interpolation expression language-csharp number" style="color:#e09142">1</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">steps</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">[</span><span class="token interpolation-string interpolation expression language-csharp">i</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">]</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">  [</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">status</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">]</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">currentMarker</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        sb</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">AppendLine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;All steps hit: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp function" style="color:#9a86fd">AllStepsHit</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">(</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">)</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        sb</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">AppendLine</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Has completed all steps: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">hasCompletedAllSteps</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        UnityEngine</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Debug</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Log</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">sb</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ToString</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>Tracks runtime progress through a single combo chain:
current step, hits, and completion status.</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="state-layer">State Layer<a href="#state-layer" class="hash-link" aria-label="Direct link to State Layer" title="Direct link to State Layer">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combostatecs"><code>ComboState.cs</code><a href="#combostatecs" class="hash-link" aria-label="Direct link to combostatecs" title="Direct link to combostatecs">​</a></h3>
<p>The <strong>ComboState</strong> is the runtime data container that holds everything the combo system knows about the <em>current</em> combat situation.
It’s never responsible for gameplay logic or animation, but only for <strong>remembering state</strong> between frames and inputs.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboState.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">nullable</span><span class="token preprocessor property" style="color:#9a86fd"> enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">System</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Serializable</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ComboState</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">List</span><span class="token return-type class-name punctuation" style="color:#6c6783">&lt;</span><span class="token return-type class-name">AttackType</span><span class="token return-type class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> inputHistory </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">set</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">List</span><span class="token return-type class-name punctuation" style="color:#6c6783">&lt;</span><span class="token return-type class-name">ActiveCombo</span><span class="token return-type class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> activeCombos </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">set</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">ActiveCombo</span><span class="token return-type class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> currentActiveChain </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">set</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">ActiveCombo</span><span class="token return-type class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> pendingFinisher </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">get</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">set</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> hasActive </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> activeCombos</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count </span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> hasCompletedAllSteps </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> currentActiveChain </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> currentActiveChain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">hasCompletedAllSteps</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> canLaunchFinisher </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> currentActiveChain </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">currentActiveChain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">requiresAllHits </span><span class="token operator" style="color:#e09142">||</span><span class="token plain"> currentActiveChain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">AllStepsHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SetPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ActiveCombo</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> pendingFinisher </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ClearPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> pendingFinisher </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ClearTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        inputHistory</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Clear</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        activeCombos</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Clear</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        pendingFinisher </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ClearAll</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">ClearTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        currentActiveChain </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This table summarizes its conceptual role:</p>
<table><thead><tr><th>Category</th><th>Description</th></tr></thead><tbody><tr><td><strong>Purpose</strong></td><td>Holds transient runtime data such as input history, active combo chains, and current progression.</td></tr><tr><td><strong>Ownership</strong></td><td>Only the <code>ComboManager</code> writes to it; other systems (UI, analytics, VFX) can read from it.</td></tr><tr><td><strong>Persistence</strong></td><td>It’s serializable for debugging and playtesting, but never saved between sessions.</td></tr><tr><td><strong>Pending Finishers</strong></td><td>Stores deferred finishers if a combo just ended but the system needs to wait before triggering it (e.g., player started a new chain immediately).</td></tr></tbody></table>
<p>With this, we can keep the <strong>manager stateless</strong> since it just manipulates <code>ComboState</code>. It makes debugging straightforward and allows new runtime tools (e.g. “combo replay visualizer” or analytics) without touching the core logic.</p>
<p>Perfect — here’s how to document and present <strong><code>ComboTiming</code></strong>, the second pillar of your <em>State Layer</em>.
It’s short and important — it gives the combo system its sense of <em>tempo</em>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combotiming"><code>ComboTiming</code><a href="#combotiming" class="hash-link" aria-label="Direct link to combotiming" title="Direct link to combotiming">​</a></h3>
<p>The <strong>ComboTiming</strong> class represents the <strong>temporal state</strong> of the combo system. It tracks when combo windows <strong>open</strong> and <strong>close</strong>, and exposes simple predicates to help the <code>ComboManager</code> decide when chaining is allowed.</p>
<p>It never plays animations or checks inputs directly; it only holds timestamps.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboTiming.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">System</span><span class="token attribute class-name punctuation" style="color:#6c6783">.</span><span class="token attribute class-name">Serializable</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ComboTiming</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Core timing flags</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> manualTimingControlActive</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// true if using manual window timing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> comboWindowOpen</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain">           </span><span class="token comment" style="color:#6c6783">// true while player can chain attacks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> attackInProgress</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain">          </span><span class="token comment" style="color:#6c6783">// true while attack animation is active</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">AttackType</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> queuedAttackType</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain">   </span><span class="token comment" style="color:#6c6783">// one buffered attack type, if any</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Combo window tracking</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> windowStartTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> windowEndTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Semantic helpers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> HasQueue </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> queuedAttackType </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> IsIdle </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">attackInProgress </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> queuedAttackType </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Methods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ---------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Reset</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> includeQueue </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        attackInProgress </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">includeQueue</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            queuedAttackType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SetComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> start</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> end</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowStartTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> start</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowEndTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> end</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ShouldOpenWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">comboWindowOpen </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> now </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> windowStartTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ShouldCloseWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> comboWindowOpen </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> now </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> windowEndTime</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ClearWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowStartTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        windowEndTime </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The table below summarises its conceptual role:</p>
<table><thead><tr><th>Category</th><th>Description</th></tr></thead><tbody><tr><td><strong>Purpose</strong></td><td>Defines the timing boundaries (<code>openTime</code>, <code>closeTime</code>) of the combo input window.</td></tr><tr><td><strong>Responsibility</strong></td><td>Only knows <em>when</em> events happen — never triggers them itself.</td></tr><tr><td><strong>Used by</strong></td><td><code>ComboManager</code> (which polls <code>ShouldOpenWindow()</code> and <code>ShouldCloseWindow()</code> every frame).</td></tr><tr><td><strong>Stateful Fields</strong></td><td>Tracks queued input (buffered attack) and recovery phase between moves.</td></tr></tbody></table>
<p><code>ComboTiming</code> acts as a <strong>stopwatch</strong>, not a conductor. It simply keeps track of time and the <code>ComboManager</code> decides what to do when that time runs out.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="logic-layer">Logic Layer<a href="#logic-layer" class="hash-link" aria-label="Direct link to Logic Layer" title="Direct link to Logic Layer">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="comboresolvercs"><code>ComboResolver.cs</code><a href="#comboresolvercs" class="hash-link" aria-label="Direct link to comboresolvercs" title="Direct link to comboresolvercs">​</a></h3>
<p>The resolver is the <strong>decision-maker</strong> of the system.
It takes the current active combos, the new input, and determines:</p>
<ol>
<li>Which chains can advance.</li>
<li>Which new chains should start.</li>
<li>Which one is the <strong>best</strong> to execute right now.</li>
</ol>
<p>It never plays animations or handles stamina. It just performs <strong>data matching</strong>.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboResolver.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Linq</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">nullable</span><span class="token preprocessor property" style="color:#9a86fd"> enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Determines which combos advance or start when a new input arrives.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ComboResolver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name">ComboChain</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> comboChains</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token class-name punctuation" style="color:#6c6783">.</span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">,</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> log</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// optional log hook</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ComboResolver</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">List</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name">ComboChain</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> comboChains</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token class-name punctuation" style="color:#6c6783">.</span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">,</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> log </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboChains </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> comboChains</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">log </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> log</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Given the current active combos and an input, returns the new set of active combos.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// May advance existing combos and/or start new ones.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">List</span><span class="token return-type class-name punctuation" style="color:#6c6783">&lt;</span><span class="token return-type class-name">ActiveCombo</span><span class="token return-type class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Resolve</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">List</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name">ActiveCombo</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> current</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">AttackType</span><span class="token plain"> input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> nextActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">List</span><span class="token constructor-invocation class-name punctuation" style="color:#6c6783">&lt;</span><span class="token constructor-invocation class-name">ActiveCombo</span><span class="token constructor-invocation class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> advanced </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> started </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Advance existing combos if the next step matches the input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> combo </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> current</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> next </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex </span><span class="token operator" style="color:#e09142">+</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">next </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">next</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackType </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> next</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                nextActive</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Add</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                advanced</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    </span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Advanced combo &lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">combo</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt; → step </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">next </span><span class="token interpolation-string interpolation expression language-csharp operator" style="color:#e09142">+</span><span class="token interpolation-string interpolation expression language-csharp"> </span><span class="token interpolation-string interpolation expression language-csharp number" style="color:#e09142">1</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Start new combos whose first step matches the input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> chain </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> comboChains</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> alreadyTracked </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> nextActive</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Any</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">c </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> c</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">chain </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> startsNew </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">!</span><span class="token plain">alreadyTracked </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                             chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count </span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                             chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackType </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> input</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">startsNew</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> newCombo </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ActiveCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">chain</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                nextActive</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Add</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">newCombo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                started</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    </span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Started new combo &lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt; (first step: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">input</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">)&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Success</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Resolved combos: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">nextActive</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">Count</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> active (</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">advanced</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> advanced, </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">started</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> started)&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> nextActive</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Chooses the best combo among currently active ones (deepest or completed first).</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name">ActiveCombo</span><span class="token return-type class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SelectBest</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">List</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name">ActiveCombo</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> active</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">active</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> active</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">OrderByDescending</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">c </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> c</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">hasCompletedAllSteps</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// prefer finished chains</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ThenByDescending</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">c </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> c</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain">          </span><span class="token comment" style="color:#6c6783">// else deepest progress</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">FirstOrDefault</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>How <code>Resolve</code> works:</p>
<ul>
<li>
<p><strong>Advancement phase:</strong>
For each currently active combo, if the new input matches its next <code>ComboStep.attackType</code>, that combo advances.</p>
</li>
<li>
<p><strong>Creation phase:</strong>
If the input matches the opener of a new combo chain, a new <code>ActiveCombo</code> is created.</p>
</li>
<li>
<p><strong>Return phase</strong>: returns a new list of active combos based on this input</p>
</li>
</ul>
<p>It also offers a selection logic:</p>
<ul>
<li>Among all active combos, <code>SelectBest()</code> picks the one that either</li>
<li>has completed all steps, or (if unavailable)</li>
<li>has the deepest progress (<code>currentIndex</code>).</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="comboexecutorcs"><code>ComboExecutor.cs</code><a href="#comboexecutorcs" class="hash-link" aria-label="Direct link to comboexecutorcs" title="Direct link to comboexecutorcs">​</a></h3>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboExecutor.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">nullable</span><span class="token preprocessor property" style="color:#9a86fd"> enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Handles the execution of a single combo step:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// plays animation, consumes stamina, applies cooldown,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// and sets up combo timing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ComboExecutor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">Animator</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">PlayerRuntimeStats</span><span class="token plain"> stats</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">CombatConfig</span><span class="token plain"> config</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">CooldownManager</span><span class="token plain"> cooldowns</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> attackLayerIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">System</span><span class="token class-name punctuation" style="color:#6c6783">.</span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">,</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> log</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// optional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ComboExecutor</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">Animator</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">PlayerRuntimeStats</span><span class="token plain"> stats</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">CombatConfig</span><span class="token plain"> config</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">CooldownManager</span><span class="token plain"> cooldowns</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> attackLayerIndex</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name">System</span><span class="token class-name punctuation" style="color:#6c6783">.</span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">,</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> log </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">animator </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">stats </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> stats</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">config </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">cooldowns </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> cooldowns</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackLayerIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> attackLayerIndex</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">log </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> log</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Executes the provided combo step and configures timing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// Returns true if this step uses animation events for combo window control.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Execute</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ActiveCombo</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">ref</span><span class="token plain"> </span><span class="token class-name">ComboTiming</span><span class="token plain"> timing</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> step </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentStep</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> data </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> attackType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">Log</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Execute </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">data</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">name</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">data</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">animTrigger</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> (stamina </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">data</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">staminaCost</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">, cooldown </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">data</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">cooldown</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">)&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Event</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// trigger animation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetTrigger</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">animTrigger</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// apply stamina &amp; cooldown</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        stats</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">UseStamina</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">staminaCost </span><span class="token operator" style="color:#e09142">*</span><span class="token plain"> config</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">staminaCostMultiplier</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        cooldowns</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Set</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">cooldown</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// check animation events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> hasAnimEvents </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">HasComboEvents</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">animTrigger</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">hasAnimEvents</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">Log</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Using animation-event combo windows for </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">data</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">clip</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">name</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Event</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// compute manual window</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> clipLength </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">GetClipLength</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">clipLength </span><span class="token operator" style="color:#e09142">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> clipLength </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.5f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> startRatio</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> endRatio</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">step</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">useWindowOverride</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            startRatio </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboWindowStart</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            endRatio </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboWindowEnd</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">Log</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Using AttackData Override window (</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">startRatio</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">–</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">endRatio</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">)&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Event</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            startRatio </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">defaultComboWindowStart</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            endRatio </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">defaultComboWindowEnd</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">Log</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Using CombatConfig Default window (</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">startRatio</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">–</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">endRatio</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">)&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Event</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> start </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">time </span><span class="token operator" style="color:#e09142">+</span><span class="token plain"> startRatio </span><span class="token operator" style="color:#e09142">*</span><span class="token plain"> clipLength</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> end </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">time </span><span class="token operator" style="color:#e09142">+</span><span class="token plain"> endRatio </span><span class="token operator" style="color:#e09142">*</span><span class="token plain"> clipLength</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">start</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> end</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Helper Methods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Log</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> message</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> color </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;#FFFFFF&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">HasComboEvents</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> animName</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">runtimeAnimatorController </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> clip </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">runtimeAnimatorController</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">animationClips</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">clip</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">name </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> animName</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">continue</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> evt </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> clip</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">events</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">evt</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">functionName </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">nameof</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">ComboManager</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">OpenComboWindow</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">||</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    evt</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">functionName </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">nameof</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">ComboManager</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">CloseComboWindow</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">GetClipLength</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ActiveCombo</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> data </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentStep</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token plain">clip </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.5f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> speed </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> animator </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">?</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">speed </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1f</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> data</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">clip</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">length </span><span class="token operator" style="color:#e09142">/</span><span class="token plain"> Mathf</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Max</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">speed</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.0001f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The table below summarises its behavior:</p>
<table><thead><tr><th>Step</th><th>Purpose</th><th>Notes</th></tr></thead><tbody><tr><td>1. Resource checks</td><td>Ensures player has stamina and no cooldown conflict.</td><td>Cancels attack if failed.</td></tr><tr><td>2. Animation trigger</td><td>Fires the Animator trigger from <code>AttackData</code>.</td><td>Decoupled from logic.</td></tr><tr><td>3. Cooldown setup</td><td>Starts cooldown timer for this attack.</td><td>Prevents immediate reuse.</td></tr><tr><td>4. Timing setup</td><td>Defines open/close times for chaining.</td><td>Used by <code>ComboManager</code> each frame.</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_vXIg"><p>This class is Compositional because:</p><ul>
<li><strong>No awareness</strong> of combos, branching, or finishers.</li>
<li><strong>No dependency</strong> on <code>ComboManager</code> — it’s just invoked by it.</li>
<li><strong>Self-contained</strong>: can be tested or reused by AI or cutscene logic.</li>
</ul></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="setting-combo-window-open-and-close-timing">Setting Combo Window Open and Close Timing<a href="#setting-combo-window-open-and-close-timing" class="hash-link" aria-label="Direct link to Setting Combo Window Open and Close Timing" title="Direct link to Setting Combo Window Open and Close Timing">​</a></h3>
<p>Right now there are three methods to do so: via Animation Event, via <code>ComboStep</code> window override or via global <code>CombatConfig</code> (order of decreasing priority).</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="animation-events-highest-priority">Animation Events (Highest Priority)<a href="#animation-events-highest-priority" class="hash-link" aria-label="Direct link to Animation Events (Highest Priority)" title="Direct link to Animation Events (Highest Priority)">​</a></h4>
<p>In this method, each animation clip of that attack move (defined in <code>AttackData</code>) must have created two events that is connected to the callback: <code>ComboManager.OpenComboWindow</code> and <code>ComboManager.CloseComboWindow</code>. This way, <code>ComboManager</code> will <span class="orange-bold">not</span> manually keep track of the combo window time via <code>Update()</code> or call the Open/Close methods manually.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combostep-override"><code>ComboStep</code> Override<a href="#combostep-override" class="hash-link" aria-label="Direct link to combostep-override" title="Direct link to combostep-override">​</a></h4>
<p>You can optionally set your own combo window (in terms of % of the clip length) for each Combat Step:</p>
<section><img src="/50033/assets/images/2025-10-10-10-23-49-814873c94fc7784514e6703a4e0ca91a.png" class="center_image_tcFY" style="width:100%"></section>
<p>ComboManager will manually call <code>Open/CloseComboWindow</code> methods and track combo window time via<code> Update()</code> with these values.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combatconfig-global-value-lowest-priority"><code>CombatConfig</code> global value (Lowest Priority)<a href="#combatconfig-global-value-lowest-priority" class="hash-link" aria-label="Direct link to combatconfig-global-value-lowest-priority" title="Direct link to combatconfig-global-value-lowest-priority">​</a></h4>
<p>If you didn&#x27;t set the Animation Events or set the override in the Combo Step, then the system will use the values in <code>CombatConfig</code>:</p>
<section><img src="/50033/assets/images/2025-10-10-10-25-24-a6c6f55a6c5f3f30ca7e37af897ae9a5.png" class="center_image_tcFY" style="width:100%"></section>
<p>ComboManager will also manually call <code>Open/CloseComboWindow</code> methods and track combo window time via<code> Update()</code> with these values.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="finisherevaluatorcs"><code>FinisherEvaluator.cs</code><a href="#finisherevaluatorcs" class="hash-link" aria-label="Direct link to finisherevaluatorcs" title="Direct link to finisherevaluatorcs">​</a></h3>
<p>The <strong>FinisherEvaluator</strong> is a lightweight component that decides <em>when and how</em> to trigger a finisher animation.
It doesn’t contain combo resolution or timing logic as those are handled by <code>ComboManager</code> (later).
Its sole responsibility is to <strong>translate a completed combo into a final animation trigger.</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">FinisherEvaluator.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">nullable</span><span class="token preprocessor property" style="color:#9a86fd"> enable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">FinisherEvaluator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">Animator</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">readonly</span><span class="token plain"> </span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">,</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> log</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">FinisherEvaluator</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">Animator</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">Action</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">,</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token class-name punctuation" style="color:#6c6783">?</span><span class="token plain"> log </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">animator </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">this</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">log </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> log</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">TryFinishForChain</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ActiveCombo</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> trigger </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentStep</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token plain">outcomeTrigger</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">string</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">IsNullOrEmpty</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">trigger</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;[Finisher] Triggered for </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">combo</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">trigger</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetTrigger</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">trigger</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">TryFinish</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ComboState</span><span class="token plain"> state</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">state</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">hasCompletedAllSteps</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Finisher not available: combo not completed yet.&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">state</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">canLaunchFinisher</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            state</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">DebugPrintHits</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Finisher blocked: not all hits landed.&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> chain </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">chain</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> finalStep </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentStep</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> trigger </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> finalStep</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token plain">outcomeTrigger</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">string</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">IsNullOrEmpty</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">trigger</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        log</span><span class="token punctuation" style="color:#6c6783">?.</span><span class="token function" style="color:#9a86fd">Invoke</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Finisher triggered: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">trigger</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetTrigger</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">trigger</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The table below summarizes its key points:</p>
<table><thead><tr><th>Responsibility</th><th>Description</th></tr></thead><tbody><tr><td><strong>Trigger animation</strong></td><td>Plays the <code>outcomeTrigger</code> from the final <code>AttackData</code> when a combo completes.</td></tr><tr><td><strong>No timing logic</strong></td><td>Called by <code>ComboManager</code> only when the combo can no longer continue.</td></tr><tr><td><strong>Optional validation</strong></td><td>Can check for hit confirmation (<code>AllStepsHit()</code>) or chain completion before firing.</td></tr><tr><td><strong>Data-driven</strong></td><td>Finisher type and animation are defined entirely in <code>AttackData</code>.</td></tr></tbody></table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="runtime-layer-the-orchestrator-combomanager">Runtime Layer: The Orchestrator <code>ComboManager</code><a href="#runtime-layer-the-orchestrator-combomanager" class="hash-link" aria-label="Direct link to runtime-layer-the-orchestrator-combomanager" title="Direct link to runtime-layer-the-orchestrator-combomanager">​</a></h2>
<p>In this architecture, the <code>ComboManager</code> is the <span class="orange-bold">orchestrator</span> and state machine that governs the rhythm of combat.</p>
<p>It controls <em>when</em> the player can act, <em>when</em> a combo window opens or closes, <em>when</em> animations start or finish, and <em>when</em> finishers are evaluated.</p>
<p>We can think of it as the conductor of a live orchestra: every subsystem (resolver, executor, evaluator, etc.) is an instrument, but the <code>ComboManager</code> cues them at the right moment.</p>
<!-- -->
<br>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Philosophy</div><div class="admonitionContent_vXIg"><p>The key insight is that the manager never “knows” what combo it’s executing. It in an <em>orchestrator</em>.
It simply interprets a pattern of inputs against a table of data and lets the data dictate the result.</p><p>The <code>ComboManager</code> also doesn’t contain gameplay logic, <em>it coordinates it</em>.</p><p>It <span class="orange-bold">delegates</span> to the <code>Resolver</code>, <code>Executor</code>, <code>CooldownManager</code> and <code>FinisherEvaluator</code> subsystems while holding no hardcoded knowledge about what specific combo or animation is being played.</p><p>This separation makes it compositional and testable and ensures designers can balance timing, stamina, or even entire combo trees without writing a single line of code.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="combomanagercs"><code>ComboManager.cs</code><a href="#combomanagercs" class="hash-link" aria-label="Direct link to combomanagercs" title="Direct link to combomanagercs">​</a></h3>
<div class="language-cs codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockTitle_Ktv7">ComboManager.cs</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cs codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">UnityEngine</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">InputSystem</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Collections</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Generic</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Linq</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">using</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">System</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Data</span><span class="token namespace punctuation" style="opacity:0.7;color:#6c6783">.</span><span class="token namespace" style="opacity:0.7">Common</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Handles input pattern matching, stamina usage, cooldowns, and combo timing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Works with PlayerContext, PlayerRuntimeStats, ComboChain, and AttackDataSO.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// Branch-aware sequential architecture: each ComboChain is ordered steps,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// and multiple active combos may coexist when prefixes overlap.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">/// &lt;/summary&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token function" style="color:#9a86fd">RequireComponent</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token keyword" style="color:#ffcc99">typeof</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token type-expression class-name">Animator</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">RequireComponent</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments keyword" style="color:#ffcc99">typeof</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments type-expression class-name">PlayerContext</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">class</span><span class="token plain"> </span><span class="token class-name">ComboManager</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token type-list class-name">MonoBehaviour</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// CONFIGURATION</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Combo Data&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">List</span><span class="token class-name punctuation" style="color:#6c6783">&lt;</span><span class="token class-name">ComboChain</span><span class="token class-name punctuation" style="color:#6c6783">&gt;</span><span class="token plain"> comboChains</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Runtime References&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name">Animator</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> AnimatorAttackLayerIndex </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">[</span><span class="token attribute class-name">Header</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">(</span><span class="token attribute attribute-arguments string" style="color:#ffcc99">&quot;Debug Settings&quot;</span><span class="token attribute attribute-arguments punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> enableDebugLogs </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// RUNTIME CONTEXT &amp; COMPONENT REFERENCES</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">PlayerContext</span><span class="token plain"> context</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">PlayerRuntimeStats</span><span class="token plain"> runtimeStats</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">CombatConfig</span><span class="token plain"> combatConfig</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// STATE TRACKING</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">ComboState</span><span class="token plain"> comboState </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">CooldownManager</span><span class="token plain"> cooldownManager </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">ComboTiming</span><span class="token plain"> timing</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// LOGIC COMPONENTS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">ComboResolver</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">ComboExecutor</span><span class="token plain"> executor</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token class-name">FinisherEvaluator</span><span class="token plain"> finisher</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// METHODS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">//=====================================================================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">region</span><span class="token preprocessor property" style="color:#9a86fd"> Setup &amp; Lifecycle</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Awake</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        context </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">PlayerContext</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        runtimeStats </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">runtimeStats</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        combatConfig </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">combatConfig</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        resolver </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ComboResolver</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboChains</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogCombo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        executor </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ComboExecutor</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> runtimeStats</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> combatConfig</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> cooldownManager</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> AnimatorAttackLayerIndex</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogCombo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        finisher </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">FinisherEvaluator</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogCombo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Initialized ComboManager&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Debug</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Start</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> chain </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> comboChains</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;[Init] Chain &#x27;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&#x27; has </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">steps</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">Count</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> steps:&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">int</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> i</span><span class="token operator" style="color:#e09142">++</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> step </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> trigger </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> step</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">?</span><span class="token plain"> step</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">animTrigger </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;&lt;null&gt;&quot;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> patternSoFar </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">string</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Join</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;, &quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Take</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">i </span><span class="token operator" style="color:#e09142">+</span><span class="token plain"> </span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    </span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Select</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">s </span><span class="token operator" style="color:#e09142">=&gt;</span><span class="token plain"> s</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ToString</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;    Step </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">i </span><span class="token interpolation-string interpolation expression language-csharp operator" style="color:#e09142">+</span><span class="token interpolation-string interpolation expression language-csharp"> </span><span class="token interpolation-string interpolation expression language-csharp number" style="color:#e09142">1</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">: [</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">patternSoFar</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">] → </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">trigger</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Update</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        runtimeStats</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TickRegen</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">deltaTime</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        cooldownManager</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Tick</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">deltaTime</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">HandleComboWindowTiming</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LaunchQueuedAttack</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">IsCurrentClipSameAs</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">Animator</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name">AnimationClip</span><span class="token plain"> targetClip</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">targetClip </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> clips </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">GetCurrentAnimatorClipInfo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">AnimatorAttackLayerIndex</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">clips</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Length </span><span class="token operator" style="color:#e09142">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// Debug.Log($&quot;Clip {clips[0].clip}&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">clips</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">clip </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> targetClip</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">LaunchQueuedAttack</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token function" style="color:#9a86fd">IsCurrentClipSameAs</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentStep</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">clip</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> state </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">GetCurrentAnimatorStateInfo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token number" style="color:#e09142">1</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token comment" style="color:#6c6783">// Debug.Log($&quot;Current state normalised time: {state.normalizedTime}&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">normalizedTime </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.975f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    </span><span class="token comment" style="color:#6c6783">// mark early finish flag at 97.5% to account for slight delay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                    </span><span class="token function" style="color:#9a86fd">OnAttackFinished</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">HandleComboWindowTiming</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">manualTimingControlActive</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> now </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ShouldOpenWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">OpenComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">else</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ShouldCloseWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">CloseComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">endregion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">region</span><span class="token preprocessor property" style="color:#9a86fd"> Input Handling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CanAttack</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">AttackType</span><span class="token plain"> attackType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">runtimeStats</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">HasEnoughStamina</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token number" style="color:#e09142">1f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Not enough stamina to attack&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">cooldownManager</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">IsOnCooldown</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">out</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">float</span><span class="token plain"> remaining</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;[</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">] is still on cooldown: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">remaining</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">s remaining&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Error</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Combo cancelled due to cooldown&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">SoftClearComboTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// soft clear tracking, keep current chain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">HandleAttackInput</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">AttackType</span><span class="token plain"> attackType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Input received: &lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt; while attack in progress: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">timing</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">attackInProgress</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// early termination</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token function" style="color:#9a86fd">CanAttack</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// If no attack in progress then resolve and execute immediately</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">inputHistory</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Add</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Resolve</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> attackType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> best </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SelectBest</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">best </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token comment" style="color:#6c6783">// if nothing advanced or started -&gt; trigger pending finisher once this combo closes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Input </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> did not advance any chain; will finish pending finisher if any: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">comboState</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">pendingFinisher</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Warning</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// check if this best is a new chain, if yes, trigger finisher now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">best</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                finisher</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TryFinishForChain</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// if not, it means something advanced, clear the pending finisher</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> step </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> best</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentStep</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">(</span><span class="token interpolation-string interpolation expression language-csharp">best</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">hasCompletedAllSteps </span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">?</span><span class="token interpolation-string interpolation expression language-csharp"> </span><span class="token interpolation-string interpolation expression language-csharp string" style="color:#ffcc99">&quot;Will complete&quot;</span><span class="token interpolation-string interpolation expression language-csharp"> </span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation expression language-csharp"> </span><span class="token interpolation-string interpolation expression language-csharp string" style="color:#ffcc99">&quot;Will continue&quot;</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">)</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> combo: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;&lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">best</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt; | Step </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">best</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">currentIndex </span><span class="token interpolation-string interpolation expression language-csharp operator" style="color:#e09142">+</span><span class="token interpolation-string interpolation expression language-csharp"> </span><span class="token interpolation-string interpolation expression language-csharp number" style="color:#e09142">1</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">/</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">best</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">steps</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">Count</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> | &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Attack: &lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">step</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt;&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                best</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">hasCompletedAllSteps </span><span class="token punctuation" style="color:#6c6783">?</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Success </span><span class="token punctuation" style="color:#6c6783">:</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Highlight</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">ExecuteStep</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">best</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// otherwise add to queue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// check if there&#x27;s space</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;ADD queued attack: &lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt;&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Highlight</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> attackType</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token comment" style="color:#6c6783">// check if combo window is open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboWindowOpen</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token comment" style="color:#6c6783">// we do nothing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Window already closed, will reset combo state&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;REPLACE queued attack: &lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt;&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Highlight</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// queue already full, we just replace it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> attackType</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">SoftClearComboTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">// removes input history and activecombos but keeps currentActiveCombo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">endregion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">region</span><span class="token preprocessor property" style="color:#9a86fd"> Execution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ExecuteStep</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ActiveCombo</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> usesAnimEvents </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> executor</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Execute</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">ref</span><span class="token plain"> timing</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">OnAttackStarted</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">hasCompletedAllSteps</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;[Pending Finisher loaded] </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">combo</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> marked as finisher candidate&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Highlight</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// if manual timing is used, executor already set windowStart/End inside timing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">usesAnimEvents</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token comment" style="color:#6c6783">//  explicitly re-arm timing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">endregion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">region</span><span class="token preprocessor property" style="color:#9a86fd"> Finisher Logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ConfirmHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Hit confirmed, but no active attack step: ignored&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Warning</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Hit confirmed during attack: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">comboState</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">currentActiveChain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">currentStep</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">attackData</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">name</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Success</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> combo </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex </span><span class="token operator" style="color:#e09142">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">||</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">chain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">steps</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Count</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                </span><span class="token keyword" style="color:#ffcc99">continue</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">RegisterHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">DebugPrintHits</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OpenComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Window OPEN at </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">Time</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">time</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Highlight</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CloseComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> fromComboFinish </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Window CLOSE at </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">Time</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">time</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Highlight</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Don’t finish if something is queued</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;Queued attack exists; delaying finisher&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// The right condition to fire here: no queue + pending finisher</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Triggering finisher: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">comboState</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">pendingFinisher</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chain</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">chainName</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Success</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            finisher</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TryFinishForChain</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">SoftClearComboTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">endregion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">region</span><span class="token preprocessor property" style="color:#9a86fd"> Reset &amp; State Management</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// Clears lists but keeps current chain and current timing state (your old ResetComboState behavior)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">SoftClearComboTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;SoftClearComboTracking&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnAttackStarted</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Attack Animation STARTED at </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">Time</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">time</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99"> &lt;color=#7FFFD4&gt;&lt;b&gt;ComboTiming @ </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">context</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt;&lt;/color&gt;\n</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">timing</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnAttackFinished</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Attack Animation FINISHED at at </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">Time</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">time</span><span class="token interpolation-string interpolation format-string punctuation" style="color:#6c6783">:</span><span class="token interpolation-string interpolation format-string">F2</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// Check for queued attack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Executing queued attack </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">timing</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">queuedAttackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Success</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">HandleAttackInput</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token string" style="color:#ffcc99">&quot;No queued attack found&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Info</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">endregion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">region</span><span class="token preprocessor property" style="color:#9a86fd"> Debug &amp; Logging</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> message</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token class-name keyword" style="color:#ffcc99">string</span><span class="token plain"> color </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;#FFFFFF&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">enableDebugLogs</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">LogDebug</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> color</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;ComboManager&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token preprocessor property" style="color:#9a86fd">#</span><span class="token preprocessor property directive keyword" style="color:#ffcc99">endregion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="unpacking-the-manager">Unpacking the Manager<a href="#unpacking-the-manager" class="hash-link" aria-label="Direct link to Unpacking the Manager" title="Direct link to Unpacking the Manager">​</a></h3>
<p><strong>Composition over inheritance</strong>: as mentioned, <code>ComboManager</code> wires small, single-purpose modules and coordinates timing. It never hardcodes “what” a move does but <span class="orange-bold">only</span> “when” to advance, finish, or reset.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="collaborators-composition">Collaborators (composition)<a href="#collaborators-composition" class="hash-link" aria-label="Direct link to Collaborators (composition)" title="Direct link to Collaborators (composition)">​</a></h4>
<ul>
<li><strong>Data:</strong> <code>ComboChain</code> (list), <code>CombatConfig</code> (via <code>PlayerContext</code>)</li>
<li><strong>State:</strong> <code>ComboState</code>, <code>ComboTiming</code></li>
<li><strong>Logic:</strong> <code>ComboResolver</code>, <code>ComboExecutor</code>, <code>FinisherEvaluator</code>, <code>CooldownManager</code></li>
<li><strong>Engine:</strong> <code>Animator</code> (attack layer index configurable)</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="lifecycle--wiring">Lifecycle &amp; wiring<a href="#lifecycle--wiring" class="hash-link" aria-label="Direct link to Lifecycle &amp; wiring" title="Direct link to Lifecycle &amp; wiring">​</a></h4>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">Awake</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  context </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token generic-method function" style="color:#9a86fd">GetComponent</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&lt;</span><span class="token generic-method generic class-name">PlayerContext</span><span class="token generic-method generic class-name punctuation" style="color:#6c6783">&gt;</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  runtimeStats </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">runtimeStats</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  combatConfig </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">combatConfig</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  resolver  </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ComboResolver</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboChains</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogCombo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  executor  </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ComboExecutor</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> runtimeStats</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> combatConfig</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> cooldownManager</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> AnimatorAttackLayerIndex</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogCombo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  finisher  </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">FinisherEvaluator</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogCombo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  timing    </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ComboTiming</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong><code>Start()</code></strong>: logs each chain &amp; step (great for authoring/debug).</li>
<li><strong><code>Update()</code></strong>: ticks stamina &amp; cooldowns, polls timing, and checks clip completion (via <code>LaunchQueuedAttack()</code>).</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="input-path-no-attack-in-progress">Input path (no attack in progress)<a href="#input-path-no-attack-in-progress" class="hash-link" aria-label="Direct link to Input path (no attack in progress)" title="Direct link to Input path (no attack in progress)">​</a></h4>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">HandleAttackInput</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">AttackType</span><span class="token plain"> atk</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token function" style="color:#9a86fd">CanAttack</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">atk</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">inputHistory</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Add</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">atk</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Resolve</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> atk</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> best </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> resolver</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SelectBest</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">best </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;no advance; pending finisher?&quot;</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// ✅ finisher rule: starting a new chain while one just completed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">best</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">      finisher</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TryFinishForChain</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token function" style="color:#9a86fd">ExecuteStep</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">best</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token comment" style="color:#6c6783">// else, queue/replace input while an attack is in progress</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token range operator" style="color:#e09142">..</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>What this gives you</strong>:</p>
<ul>
<li>Branch-aware resolution (multiple active chains) with a single “best” selection as determined by the <code>Resolver</code>.</li>
<li><strong>Deferred finisher</strong>: if a short chain completed and the next input starts a brand-new chain, play the old finisher <em>then</em> begin the new opener.</li>
<li>One-slot <strong>input buffer</strong> while a clip is playing.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="execution-path">Execution path<a href="#execution-path" class="hash-link" aria-label="Direct link to Execution path" title="Direct link to Execution path">​</a></h4>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ExecuteStep</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">ActiveCombo</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> usesAnimEvents </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> executor</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">Execute</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">ref</span><span class="token plain"> timing</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> combo</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token function" style="color:#9a86fd">OnAttackStarted</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">hasCompletedAllSteps</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">SetPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">combo</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">usesAnimEvents</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">manualTimingControlActive </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">true</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>ComboExecutor</code> handles: animator trigger, stamina spend, cooldown start, window times.</li>
<li>If input completes the chain, <strong>mark</strong> as pending finisher (don’t fire yet).</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="timing-loop-combo-window-openclose">Timing loop (combo window open/close)<a href="#timing-loop-combo-window-openclose" class="hash-link" aria-label="Direct link to Timing loop (combo window open/close)" title="Direct link to Timing loop (combo window open/close)">​</a></h4>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">HandleComboWindowTiming</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">manualTimingControlActive</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> now </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> Time</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ShouldOpenWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OpenComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">else</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ShouldCloseWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">now</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CloseComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Windows are <strong>data-driven</strong> (from <code>AttackData</code>) and only <strong>polled</strong> here.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="finisher-gate">Finisher gate<a href="#finisher-gate" class="hash-link" aria-label="Direct link to Finisher gate" title="Direct link to Finisher gate">​</a></h4>
<p>In almost every modern real-time action game (God of War, Devil May Cry, Bayonetta, etc.):</p>
<table><thead><tr><th>Design Element</th><th>Typical Behaviour</th></tr></thead><tbody><tr><td><strong>Single Finisher</strong></td><td>Only <strong>one finisher animation</strong> plays at the end of a chain, even if shorter combos are also complete internally.</td></tr><tr><td><strong>Completion Priority</strong></td><td>The <strong>longest valid chain</strong> takes precedence; shorter chains that share the same prefix are suppressed once the longer chain continues.</td></tr><tr><td><strong>Event Timing</strong></td><td>The finisher is evaluated only <strong>after</strong> the player fails to input within the final window, or when the last step’s animation naturally ends.</td></tr><tr><td><strong>Purpose</strong></td><td>Finishers mark the <em>intentional</em> end of a chain — a big payoff move, often resetting the state, giving recovery frames, or returning to idle.</td></tr></tbody></table>
<p>The <code>ComboManager</code> simply determines <span class="orange-bold">when</span> a finisher may fire: that is, when no valid continuation exists or a new chain begins. The actual animation and any special effects (e.g., cinematic slash) are handled by the <code>FinisherEvaluator</code>, keeping the manager purely focused on flow control.</p>
<p>Finisher can be launched by two methods:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">CloseComboWindow</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">bool</span><span class="token plain"> fromComboFinish </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">comboWindowOpen </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token comment" style="color:#6c6783">// defer if a queued input exists</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token comment" style="color:#6c6783">// if a chain had completed earlier, fire now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    finisher</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TryFinishForChain</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token function" style="color:#9a86fd">SoftClearComboTracking</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">HandleAttackInput</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name">AttackType</span><span class="token plain"> attackType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token function" style="color:#9a86fd">LogCombo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token interpolation-string string" style="color:#ffcc99">$&quot;Input received: &lt;b&gt;</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">attackType</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&lt;/b&gt; while attack in progress: </span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">{</span><span class="token interpolation-string interpolation expression language-csharp">timing</span><span class="token interpolation-string interpolation expression language-csharp punctuation" style="color:#6c6783">.</span><span class="token interpolation-string interpolation expression language-csharp">attackInProgress</span><span class="token interpolation-string interpolation punctuation" style="color:#6c6783">}</span><span class="token interpolation-string string" style="color:#ffcc99">&quot;</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> LogUtil</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Color</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Input</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// early termination</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token function" style="color:#9a86fd">CanAttack</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">attackType</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token comment" style="color:#6c6783">// If no attack in progress then resolve and execute immediately</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// find best ActiveCombo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// check if this best is a new chain, if yes, trigger finisher now</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">best</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentIndex </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">&amp;&amp;</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            finisher</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">TryFinishForChain</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">pendingFinisher</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// if not, it means something advanced, clear the pending finisher</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ClearPendingFinisher</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">        </span><span class="token comment" style="color:#6c6783">// logic continues</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>When:</strong> only when the current combo can no longer continue (window closed and no queued input).</li>
<li><strong>Also works for</strong>: the “new chain” case, as we already trigger finisher <em>before</em> executing the new opener in <code>HandleAttackInput()</code> when <code>best.currentIndex==0</code>.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="clip-completion--queued-input">Clip completion &amp; queued input<a href="#clip-completion--queued-input" class="hash-link" aria-label="Direct link to Clip completion &amp; queued input" title="Direct link to Clip completion &amp; queued input">​</a></h4>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">private</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">LaunchQueuedAttack</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token operator" style="color:#e09142">!</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress </span><span class="token operator" style="color:#e09142">||</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token function" style="color:#9a86fd">IsCurrentClipSameAs</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">animator</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentStep</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackData</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">clip</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> st </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> animator</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">GetCurrentAnimatorStateInfo</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">AnimatorAttackLayerIndex</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">st</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">normalizedTime </span><span class="token operator" style="color:#e09142">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0.975f</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnAttackFinished</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">OnAttackFinished</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">attackInProgress </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token boolean" style="color:#ffcc99">false</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    </span><span class="token function" style="color:#9a86fd">HandleAttackInput</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">    timing</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">queuedAttackType </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Ends an attack a touch early (97.5%) to guarantee deterministic follow-ups.</li>
<li>Consumes the <strong>queued</strong> input immediately after finish.</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hit-confirmation-optional">Hit confirmation (optional)<a href="#hit-confirmation-optional" class="hash-link" aria-label="Direct link to Hit confirmation (optional)" title="Direct link to Hit confirmation (optional)">​</a></h4>
<p>Not all finisher requires hit conformation. Some finisher will still play regardless of whether you hit an enemy in the previous combo steps. The following method Lets chains gate finishers on <strong>requiresAllHits</strong> without welding logic into the manager.</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token keyword" style="color:#ffcc99">public</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#ffcc99">void</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">ConfirmHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">currentActiveChain </span><span class="token operator" style="color:#e09142">==</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">null</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token keyword" style="color:#ffcc99">return</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">  </span><span class="token keyword" style="color:#ffcc99">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">(</span><span class="token class-name keyword" style="color:#ffcc99">var</span><span class="token plain"> ac </span><span class="token keyword" style="color:#ffcc99">in</span><span class="token plain"> comboState</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">activeCombos</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"> ac</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">RegisterHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> ac</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">DebugPrintHits</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#6c6783">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cooldowns--stamina-gates">Cooldowns &amp; stamina gates<a href="#cooldowns--stamina-gates" class="hash-link" aria-label="Direct link to Cooldowns &amp; stamina gates" title="Direct link to Cooldowns &amp; stamina gates">​</a></h4>
<ul>
<li><code>CanAttack(...)</code> blocks on low stamina or active cooldowns; logs and <strong>soft-clears</strong> tracking if on cooldown (keeping current clip flow intact).</li>
</ul>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="reset-utilities">Reset utilities<a href="#reset-utilities" class="hash-link" aria-label="Direct link to Reset utilities" title="Direct link to Reset utilities">​</a></h4>
<ul>
<li><strong><code>SoftClearComboTracking()</code></strong>: clears history &amp; active lists; preserves current clip state.</li>
<li><strong><code>ResetAll(keepQueued)</code></strong>: clears everything and timing; optional queue retention.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="runtime-responsibilities">Runtime Responsibilities<a href="#runtime-responsibilities" class="hash-link" aria-label="Direct link to Runtime Responsibilities" title="Direct link to Runtime Responsibilities">​</a></h3>
<table><thead><tr><th>Category</th><th>Description</th><th>Key Methods / Fields</th><th>Collaborators</th></tr></thead><tbody><tr><td><strong>Initialization &amp; Setup</strong></td><td>Loads all dependencies (context, animator, config, chains) and instantiates core logic components. Logs chain structures for debugging.</td><td><code>Awake()</code>, <code>Start()</code></td><td><code>PlayerContext</code>, <code>ComboResolver</code>, <code>ComboExecutor</code>, <code>FinisherEvaluator</code></td></tr><tr><td><strong>Frame Loop</strong></td><td>Handles stamina regen, cooldown ticking, combo window polling, and queued attack launch.</td><td><code>Update()</code>, <code>HandleComboWindowTiming()</code>, <code>LaunchQueuedAttack()</code></td><td><code>PlayerRuntimeStats</code>, <code>CooldownManager</code>, <code>ComboTiming</code></td></tr><tr><td><strong>Input Handling</strong></td><td>Reads attack inputs, validates stamina and cooldowns, performs combo resolution, queues inputs during animations.</td><td><code>HandleAttackInput()</code>, <code>CanAttack()</code></td><td><code>ComboResolver</code>, <code>ComboState</code>, <code>CooldownManager</code></td></tr><tr><td><strong>Combo Resolution</strong></td><td>Matches new inputs to active or new chains; selects the <em>best</em> chain to execute; fires finisher if previous chain completed.</td><td>Within <code>HandleAttackInput()</code></td><td><code>ComboResolver</code>, <code>FinisherEvaluator</code></td></tr><tr><td><strong>Execution &amp; Animation</strong></td><td>Plays the animation, applies resource costs, starts cooldowns, sets timing, and flags attack-in-progress.</td><td><code>ExecuteStep()</code>, <code>OnAttackStarted()</code></td><td><code>ComboExecutor</code>, <code>Animator</code>, <code>ComboTiming</code></td></tr><tr><td><strong>Timing Control</strong></td><td>Polls for window open/close and reacts accordingly — opens chaining window or closes it, possibly firing finisher.</td><td><code>HandleComboWindowTiming()</code>, <code>OpenComboWindow()</code>, <code>CloseComboWindow()</code></td><td><code>ComboTiming</code>, <code>FinisherEvaluator</code></td></tr><tr><td><strong>Finisher Handling</strong></td><td>Defers or triggers finishers depending on whether combo continues or ends; supports new-chain-before-finisher case.</td><td><code>CloseComboWindow()</code>, <code>HandleAttackInput()</code> (early check)</td><td><code>FinisherEvaluator</code>, <code>ComboState</code></td></tr><tr><td><strong>Hit Confirmation</strong></td><td>Marks successful hits for all active combos to allow hit-gated finishers (e.g., “requires all hits”).</td><td><code>ConfirmHit()</code></td><td><code>ActiveCombo</code>, <code>ComboState</code></td></tr><tr><td><strong>Cooldown &amp; Stamina</strong></td><td>Prevents execution when stamina or cooldown is insufficient; clears tracking on invalid actions.</td><td><code>CanAttack()</code>, <code>SoftClearComboTracking()</code></td><td><code>PlayerRuntimeStats</code>, <code>CooldownManager</code></td></tr><tr><td><strong>Attack Completion</strong></td><td>Detects end of animation (via normalized time) and immediately executes any queued attack.</td><td><code>LaunchQueuedAttack()</code>, <code>OnAttackFinished()</code></td><td><code>Animator</code>, <code>ComboTiming</code></td></tr><tr><td><strong>Reset Management</strong></td><td>Provides fine-grained clearing behavior for partial or full resets, preserving queued inputs if needed.</td><td><code>SoftClearComboTracking()</code>, <code>ResetAll()</code></td><td><code>ComboState</code>, <code>ComboTiming</code></td></tr><tr><td><strong>Debugging &amp; Logs</strong></td><td>Rich color-coded logging for every system event; logs each chain and its trigger pattern on start.</td><td><code>LogCombo()</code></td><td><code>LogUtil</code>, <code>Console</code></td></tr></tbody></table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-combomanager">Using <code>ComboManager</code><a href="#using-combomanager" class="hash-link" aria-label="Direct link to using-combomanager" title="Direct link to using-combomanager">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="public-interface">Public Interface<a href="#public-interface" class="hash-link" aria-label="Direct link to Public Interface" title="Direct link to Public Interface">​</a></h3>
<p>In gameplay, the <code>ComboManager</code> exposes only <strong>two callable entry points</strong>.
Everything else: timing, window checks, finisher triggers is self-managed internally within <code>Update()</code>.</p>
<table><thead><tr><th>Public Method</th><th>Called By</th><th>Purpose</th><th>Typical Source</th></tr></thead><tbody><tr><td><strong><code>HandleAttackInput(AttackType type)</code></strong></td><td>Player input controller / input reader</td><td>Main entry point for player attack commands. Parses button presses (<code>Light1</code>, <code>Heavy</code>, etc.), performs stamina/cooldown gating, and routes to <code>ComboResolver</code>.</td><td>Input event in <code>PlayerContext</code> or <code>InputReader</code> (Unity Input System callback).</td></tr><tr><td><strong><code>ConfirmHit()</code></strong></td><td>Weapon hitbox, animation event, or collision callback</td><td>Signals that the player’s current attack successfully connected with a target. Used to validate “requiresAllHits” or unlock finisher eligibility.</td><td>Triggered via <code>OnTriggerEnter</code>, animation event, or damage system callback.</td></tr></tbody></table>
<p>Everything else is private orchestration:</p>
<table><thead><tr><th>Internal Lifecycle</th><th>Triggered From</th><th>Responsibility</th></tr></thead><tbody><tr><td><code>Update()</code></td><td>Unity frame loop</td><td>Polls stamina regen, cooldown tick, timing, queued attacks.</td></tr><tr><td><code>HandleComboWindowTiming()</code></td><td>called by <code>Update()</code></td><td>Opens/closes combo window; triggers finisher when window closes with no queue.</td></tr><tr><td><code>LaunchQueuedAttack()</code></td><td>called by <code>Update()</code></td><td>Checks animator progress; launches queued input once clip nearly ends.</td></tr><tr><td><code>OnAttackStarted()</code> / <code>OnAttackFinished()</code></td><td>internal from <code>ExecuteStep()</code> and <code>LaunchQueuedAttack()</code></td><td>Tracks animation boundaries; flushes queued inputs after animation ends.</td></tr></tbody></table>
<p>In practice, <span class="orange-bold">the player input layer only calls two functions</span>:</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token comment" style="color:#6c6783">// Input callback</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">comboManager</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">HandleAttackInput</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">AttackType</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token plain">Light1</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// When weapon or animation event confirms a hit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">comboManager</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token function" style="color:#9a86fd">ConfirmHit</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sequence-diagram-player-input-to-finisher">Sequence Diagram: Player Input to Finisher<a href="#sequence-diagram-player-input-to-finisher" class="hash-link" aria-label="Direct link to Sequence Diagram: Player Input to Finisher" title="Direct link to Sequence Diagram: Player Input to Finisher">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h3>
<ul>
<li>
<p><strong>Only two public entry points</strong>: <code>HandleAttackInput()</code> and <code>ConfirmHit()</code>.</p>
</li>
<li>
<p><strong>Everything else</strong> (finisher, combo window, recovery, queued input) is internal and time-driven.</p>
</li>
<li>
<p>The <strong>sequence</strong> ensures:</p>
<ul>
<li>Finishers play only when continuation is impossible;</li>
<li>Queued attacks execute seamlessly;</li>
<li>Branching chains (shared prefixes) are handled automatically.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="runtime-examples">Runtime Examples<a href="#runtime-examples" class="hash-link" aria-label="Direct link to Runtime Examples" title="Direct link to Runtime Examples">​</a></h2>
<p>Lets use this example again:</p>
<table><thead><tr><th>Clip Name</th><th>Attack Type</th><th>Description</th></tr></thead><tbody><tr><td><code>Sword_Light1</code></td><td><code>Light1</code></td><td>First fast horizontal slash</td></tr><tr><td><code>Sword_Light2</code></td><td><code>Light2</code></td><td>Second faster returning slash</td></tr><tr><td><code>Sword_Light3</code></td><td><code>Light3</code></td><td>Third downward secondary slash</td></tr><tr><td><code>Sword_Light3_Ice</code></td><td><code>Light3</code></td><td>Downward secondary slash with Ice effect</td></tr><tr><td><code>Sword_Heavy1</code></td><td><code>Heavy</code></td><td>A slower, stamina-heavy overhead strike</td></tr></tbody></table>
<p>Combo chains (the clips played are the basic ones unless otherwise stated):</p>
<ul>
<li><strong>FireSlash</strong>: <code>Light1</code> → <code>Light2</code> (has finisher)</li>
<li><strong>IceSlash</strong>: <code>Light1</code> → <code>Light2</code> → <code>Light3</code> (no finisher), <code>Light3</code> triggers <code>Sword_Light3_Ice</code> clip (no finisher)</li>
<li><strong>GroundSlam</strong>: <code>Light1</code> → <code>Light1</code> → <code>Light2</code> → <code>Light3</code> → <code>Light1</code> (has finisher)</li>
<li><strong>Single tap</strong>: Any one-step opener (e.g., just <code>Light1</code>) should also perform a valid attack.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="runtime-timeline-a-iceslash-cancelled-fireslash-finisher-triggered">Runtime Timeline A: <em>“IceSlash Cancelled, FireSlash Finisher Triggered”</em><a href="#runtime-timeline-a-iceslash-cancelled-fireslash-finisher-triggered" class="hash-link" aria-label="Direct link to runtime-timeline-a-iceslash-cancelled-fireslash-finisher-triggered" title="Direct link to runtime-timeline-a-iceslash-cancelled-fireslash-finisher-triggered">​</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scenario">Scenario<a href="#scenario" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario">​</a></h4>
<p>The player begins with inputs meant for <strong>IceSlash</strong> (<code>Light1 → Light2 → Light3</code>), but instead of pressing <code>Light3</code>, they press <code>HeavyAttack</code>.</p>
<p>At that moment, the <code>ComboManager</code> detects that IceSlash <strong>can no longer continue</strong> and triggers
<strong>FireSlash’s finisher</strong> immediately before executing the HeavyAttack’s single animation.</p>
<p>Thus, IceSlash is cancelled mid-chain, FireSlash’s finisher plays as a payoff, and then the HeavyAttack animation follows naturally.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">Time (s)   0.00    0.45    0.80    1.20    1.60    2.00</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">           |-------|-------|-------|-------|-------|-------|----------------------------------------------------------------------------------------------|</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ⮕ Input: Light1 accepted, queue empty, process immediate</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ⮕ FireSlash, GroundSlam, IceSlash, Single tap Light1 started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ⮕ Best: Single tap Light 1 EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light1 ▶   [Anim Sword_Light1]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                     ⮕ Input: Light2 accepted, queued</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                            ⮕ Combo window ends, inp queue exist: continue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                ⮕ Anim ends, process input queue: Light2</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                ⮕ GroundSlam, Fireslash, Iceslash still valid: advanced</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                ⮕ Single tap Light2 started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                ⮕ FireSlash COMPLETED: pending finisher</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                ⮕ Best: FireSlash Step 2 EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light2 ▶                              [Anim Sword_Light2]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                        [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                  ⮕ Input: HeavyAttack accepted, queued</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                        ⮕ Combo window ends, inp queue exist: continue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                            ⮕ Anim ends, process input queue: HeavyAttack</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                            ⮕ Single tap HeavyAttack started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                            ⮕ Best: Single tap HeavyAttack</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                            ⮕ FireSlash finisher check hits &amp; TRIGGER</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                            ⮕ Best Combo Step EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">FireSlash Finisher ▶                                        [Anim Fireslash  Finisher]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Heavy ▶                                                                               [Anim HeavyAttack]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                        [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                         ⮕ Combo window closes, no input in queue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                         ⮕ No finisher detected</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                         ⮕ Combo system resets (clear history, active combos)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When an input invalidates an existing chain but belongs to another valid one,
the system promotes the new chain and <strong>plays its finisher immediately</strong> to mark the transition.
IceSlash is safely cancelled; FireSlash’s finisher gives visual closure before resuming normal attacks.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="runtime-timeline-b-iceslash-completed-groundslam-finisher-triggered-fireslash-finisher-cancelled">Runtime Timeline B: <em>“IceSlash Completed, GroundSlam Finisher Triggered, FireSlash Finisher Cancelled”</em><a href="#runtime-timeline-b-iceslash-completed-groundslam-finisher-triggered-fireslash-finisher-cancelled" class="hash-link" aria-label="Direct link to runtime-timeline-b-iceslash-completed-groundslam-finisher-triggered-fireslash-finisher-cancelled" title="Direct link to runtime-timeline-b-iceslash-completed-groundslam-finisher-triggered-fireslash-finisher-cancelled">​</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scenario-1">Scenario<a href="#scenario-1" class="hash-link" aria-label="Direct link to Scenario" title="Direct link to Scenario">​</a></h4>
<p>The player performs a long sequence:
<code>Light1 → Light1 → Light2 → Light3 → Light1</code>.</p>
<p>Here, <strong>FireSlash</strong> (<code>Light1→Light2</code>) completes cleanly at <code>Light2</code> and <strong>IceSlash</strong> (<code>Light1→Light2→Light3</code>) completes cleanly at <code>Light3</code>, but since further inputs continue into <strong>GroundSlam</strong> (<code>Light1→1→2→3→1→Heavy</code>), the finisher for FireSlash is <strong>suppressed</strong>.</p>
<p>It’s recognized as part of a longer valid chain still in progress. Only once the final Light3 <code>finishes</code>, and the combo window closes with no queued input, does the <strong>GroundSlam finisher</strong> trigger.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:#2a2734;--prism-color:#9a86fd"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="background-color:#2a2734;color:#9a86fd"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9a86fd"><span class="token plain">Time (s)   0.00    0.45    0.80    1.20    1.60    2.00    2.40    2.80    3.20</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">           |-------|-------|-------|-------|-------|-------|-------|-------|-------|----------------------------------------------------------------------------------------------------------------------------|</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ⮕ Input: Light1 accepted, queue empty, process immediate</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ⮕ FireSlash, GroundSlam, IceSlash, Single tap Light1 started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            ⮕ Best: Single tap Light 1 EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light1 ▶   [Anim Sword_Light1]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">            [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                     ⮕ Input: Light1 accepted, queued</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                            ⮕ Combo window ends, inp queue exist: continue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                              ⮕ Anim ends, process input queue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                              ⮕ FireSlash, GroundSlam, IceSlash, Single tap Light1 started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                              ⮕ Single tap Light 1 completed</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                              ⮕ Best: Single tap Light 1 EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light1 ▶                        [Anim Sword_Light1]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                  [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                      ⮕ Input: Light2 accepted, queued</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                  ⮕ Combo window ends, inp queue exist: continue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                    ⮕ Anim ends, process input queue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                    ⮕ GroundSlam, Fireslash, Iceslash still valid: advanced</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                    ⮕ Single tap Light2 started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                    ⮕ FireSlash COMPLETED: pending finisher</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                    ⮕ Best: FireSlash Step 2 EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light2 ▶                                           [Anim Sword_Light2]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                    [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                        ⮕ Input: Light3 accepted, queued</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                    ⮕ Combo window ends, inp queue exist: continue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                        ⮕ Anim ends, process input queue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                        ⮕ GroundSlam, IceSlash still valid → advanced</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                        ⮕ Single tap Light3 started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                        ⮕ Iceslash COMPLETED: pending finisher</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                        ⮕ Best: IceSlash Step 3 EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                        ⮕ Cancelled: Fireslash Finisher</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light3 ▶                                                                [Anim Sword_Light3_Ice]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                            [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                        ⮕ Input: Light1 accepted</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                            ⮕ Combo window ends, inp queue exist: continue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ Anim ends, proceress input queue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ Combo window ends, inp queue exist: continue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ GroundSlam still valid → advanced</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ FireSlash, IceSlash, Single tap Light1 started</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ Single tap Light 1 completed</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ GroundSlam COMPLETED: pending finisher</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ Best: GroundSlam Step 5 EXEC</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                ⮕ Cancelled: IceSlash Finisher</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">Light1 ▶                                                                                        [Anim Sword_Light1]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                 [⏲ Combo Window]</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                                 ⮕ Combo window closes, no input in queue</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                                 ⮕ GroundSlam Finisher check hit &amp; TRIGGER</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">                                                                                                                 ⮕ Combo system resets (clear history, active combos)</span><br></span><span class="token-line" style="color:#9a86fd"><span class="token plain">GroundSlam Finisher ▶                                                                                           [Anim GroundSlam  Finisher]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Design Reflection</div><div class="admonitionContent_vXIg"><p>These two cases show the subtle difference between <strong>interruption</strong> and <strong>extension</strong>. In Runtime A, a new input cuts off the current chain: the system finalizes what’s ending before starting what’s new.
In Runtime B, a new input extends the chain — the system defers finishers to maintain flow.</p><p>This is the essence of our resolver’s design: <strong>canceling ≠ finishing</strong>, and <strong>continuing ≠ interrupting</strong>. Those fine distinctions are what make the system feel intelligent, responsive, and alive.</p></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="preparing-the-animation-clip-and-setting-up-the-animator-fsm">Preparing the Animation Clip and Setting up the Animator FSM<a href="#preparing-the-animation-clip-and-setting-up-the-animator-fsm" class="hash-link" aria-label="Direct link to Preparing the Animation Clip and Setting up the Animator FSM" title="Direct link to Preparing the Animation Clip and Setting up the Animator FSM">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-1-create-clips-for-all-combat-movement-step-and-special-finisher-animation">Step 1: Create clips for all combat movement step and special finisher animation<a href="#step-1-create-clips-for-all-combat-movement-step-and-special-finisher-animation" class="hash-link" aria-label="Direct link to Step 1: Create clips for all combat movement step and special finisher animation" title="Direct link to Step 1: Create clips for all combat movement step and special finisher animation">​</a></h3>
<p>Create a clip for each possible movement animation, e.g: <code>Light1, Light2, Light3, HeavyAttack1, FireSlashFinisher, GroundSlamFinisher</code>, etc.</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/tutorials/combo/set-clips.mov" type="video/mp4">Your browser does not support the video tag.</video></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="step-2-create-animator-fsm">Step 2: Create Animator FSM<a href="#step-2-create-animator-fsm" class="hash-link" aria-label="Direct link to Step 2: Create Animator FSM" title="Direct link to Step 2: Create Animator FSM">​</a></h3>
<p>Each clip (combat move) should be able to be triggered from some IDLE COMBAT state. There&#x27;s no need to incorporate combo logic in the Animator FSM.</p>
<section><img src="/50033/assets/images/2025-10-10-09-36-14-c962e9fa462fa0856d6e4244673c454d.png" class="center_image_tcFY" style="width:100%"></section>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="trigger">Trigger<a href="#trigger" class="hash-link" aria-label="Direct link to Trigger" title="Direct link to Trigger">​</a></h4>
<p>The <strong>transition</strong> from IDLE COMBAT to any combat move state should <strong>not</strong> have any exit time so that the transition is immediate. You should add the appropriate <span class="orange-bold">trigger</span> parameter as defined in your <a href="#attackdatacs"><code>AttackData</code> earlier</a>:</p>
<section><img src="/50033/assets/images/2025-10-10-09-39-12-9cae4d187748d63f09425be31b4277fb.png" class="center_image_tcFY" style="width:100%"></section>
<div class="theme-admonition theme-admonition-caution alert alert--warning admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_vXIg"><p>The trigger parameter for each combat move state <span class="orange-bold">must</span> match the <code>Anim Trigger</code> or <code>Outcome Trigger</code> field in <code>AttackData</code> SO, otherwise the system fails.</p><section><img src="/50033/assets/images/Screenshot 2025-10-10 at 10.12.53 AM-58e96b6e1f7a7f7460ef6a32dca5b8df.png" class="center_image_tcFY" style="width:100%"></section></div></div>
<p>The <strong>transition</strong> from any combat move state to IDLE COMBAT should <strong>have</strong> its exit time checked so that the combat move clip plays fully without condition:</p>
<section><img src="/50033/assets/images/2025-10-10-09-40-11-f0125427d1619f064161df4bb79b053d.png" class="center_image_tcFY" style="width:100%"></section>
<p>Any &quot;cancels&quot; logic can be implemented inside <code>ComboResolver</code> instead. The Animator FSM should be made as simple as possible.</p>
<div class="theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_vXIg"><p>You can optionally <strong>add layers</strong> to your animator if you have another moveset for walking, running, jumping etc (eg: locomotive layer). Just ensure that you have assigned proper layer priority (combat &gt; locomotive) and make the IDLE COMBAT state play a clip with no markers.</p><section><img src="/50033/assets/images/2025-10-10-09-38-06-eb5b473478f8ec16116ac5b554f1e44f.png" class="center_image_tcFY" style="width:100%"></section></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="demo">Demo<a href="#demo" class="hash-link" aria-label="Direct link to Demo" title="Direct link to Demo">​</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="basic-single-tap-no-combo">Basic Single Tap (no combo)<a href="#basic-single-tap-no-combo" class="hash-link" aria-label="Direct link to Basic Single Tap (no combo)" title="Direct link to Basic Single Tap (no combo)">​</a></h3>
<p><code>Light1</code>, <code>Light2</code>, <code>Light3</code>, <code>Heavy</code>, slow tapped without invoking combos.</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/tutorials/combo/basic-single-tap.mov" type="video/mp4">Your browser does not support the video tag.</video></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="fireslash">FireSlash<a href="#fireslash" class="hash-link" aria-label="Direct link to FireSlash" title="Direct link to FireSlash">​</a></h3>
<p>FireSlash succeeds (<code>Light1 → Light2</code>).</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/tutorials/combo/fireSlash.mov" type="video/mp4">Your browser does not support the video tag.</video></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="iceslash">IceSlash<a href="#iceslash" class="hash-link" aria-label="Direct link to IceSlash" title="Direct link to IceSlash">​</a></h3>
<p>IceSlash succeeds (<code>Light1 → Light2 → Light3</code>). FireSlash finisher <strong>cancelled</strong> due to longer-chain IceSlash.</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/tutorials/combo/iceSlash.mov" type="video/mp4">Your browser does not support the video tag.</video></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="failed-iceslash">Failed IceSlash<a href="#failed-iceslash" class="hash-link" aria-label="Direct link to Failed IceSlash" title="Direct link to Failed IceSlash">​</a></h3>
<p>IceSlash failed (<code>Light1 → Light2 → late Light3</code>). FireSlash finisher <strong>fires</strong> due to Single Tap Light3 being the best step here as IceSlash failed.</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/tutorials/combo/IceSlash-late-FireSlash-finish.mov" type="video/mp4">Your browser does not support the video tag.</video></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="groundslam">GroundSlam<a href="#groundslam" class="hash-link" aria-label="Direct link to GroundSlam" title="Direct link to GroundSlam">​</a></h3>
<p>GroundSlam succeeds (<code>Light1 → Light1 → Light2 → Light3 → Light1</code>). FireSlash finisher <strong>cancelled</strong> due to longer-chain progression GroundSlam. IceSlash special clip (not finisher) after <code>Light3</code> key pressed still plays as it is completed (seen as best, as opposed to ongoing GroundSlam). In the end, GroundSlam finisher plays.</p>
<div class="center_div_ipNX"><video style="width:100%" class="center_video_QRNx" controls=""><source src="https://50033.s3.ap-southeast-1.amazonaws.com/tutorials/combo/GroundSlam-finisher-Iceslash-complete-Fireslash-compete-finisher-canceled.mov" type="video/mp4">Your browser does not support the video tag.</video></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/50033/resources/general/data-driven-stats"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Data-Driven Player Stats Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/50033/resources/general/hybrid-arch"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Hybrid Service-Adapter Architecture with ScriptableObjects</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisite" class="table-of-contents__link toc-highlight">Prerequisite</a></li><li><a href="#architecture-overview" class="table-of-contents__link toc-highlight">Architecture Overview</a><ul><li><a href="#high-level-class-composition" class="table-of-contents__link toc-highlight">High Level Class Composition</a></li><li><a href="#sample-combat-moveset-and-combo" class="table-of-contents__link toc-highlight">Sample Combat Moveset and Combo</a></li><li><a href="#the-big-picture-resolving-and-executing-combos" class="table-of-contents__link toc-highlight">The Big Picture: Resolving and Executing Combos</a></li><li><a href="#timing-example" class="table-of-contents__link toc-highlight">Timing Example</a></li></ul></li><li><a href="#system-composition-and-code-structure" class="table-of-contents__link toc-highlight">System Composition and Code Structure</a></li><li><a href="#foundation-layer-data--stateless-components" class="table-of-contents__link toc-highlight">Foundation Layer: Data &amp; Stateless Components</a><ul><li><a href="#attacktypecs" class="table-of-contents__link toc-highlight"><code>AttackType.cs</code></a></li><li><a href="#attackdatacs" class="table-of-contents__link toc-highlight"><code>AttackData.cs</code></a></li><li><a href="#combostepcs" class="table-of-contents__link toc-highlight"><code>ComboStep.cs</code></a></li><li><a href="#combochaincs" class="table-of-contents__link toc-highlight"><code>ComboChain.cs</code></a></li><li><a href="#combatconfigcs" class="table-of-contents__link toc-highlight"><code>CombatConfig.cs</code></a></li><li><a href="#playerstatscs" class="table-of-contents__link toc-highlight"><code>PlayerStats.cs</code></a></li><li><a href="#cooldownmanagercs" class="table-of-contents__link toc-highlight"><code>CooldownManager.cs</code></a></li><li><a href="#combotimingcs" class="table-of-contents__link toc-highlight"><code>ComboTiming.cs</code></a></li><li><a href="#activecombocs" class="table-of-contents__link toc-highlight"><code>ActiveCombo.cs</code></a></li></ul></li><li><a href="#state-layer" class="table-of-contents__link toc-highlight">State Layer</a><ul><li><a href="#combostatecs" class="table-of-contents__link toc-highlight"><code>ComboState.cs</code></a></li><li><a href="#combotiming" class="table-of-contents__link toc-highlight"><code>ComboTiming</code></a></li></ul></li><li><a href="#logic-layer" class="table-of-contents__link toc-highlight">Logic Layer</a><ul><li><a href="#comboresolvercs" class="table-of-contents__link toc-highlight"><code>ComboResolver.cs</code></a></li><li><a href="#comboexecutorcs" class="table-of-contents__link toc-highlight"><code>ComboExecutor.cs</code></a></li><li><a href="#setting-combo-window-open-and-close-timing" class="table-of-contents__link toc-highlight">Setting Combo Window Open and Close Timing</a></li><li><a href="#finisherevaluatorcs" class="table-of-contents__link toc-highlight"><code>FinisherEvaluator.cs</code></a></li></ul></li><li><a href="#runtime-layer-the-orchestrator-combomanager" class="table-of-contents__link toc-highlight">Runtime Layer: The Orchestrator <code>ComboManager</code></a><ul><li><a href="#combomanagercs" class="table-of-contents__link toc-highlight"><code>ComboManager.cs</code></a></li><li><a href="#unpacking-the-manager" class="table-of-contents__link toc-highlight">Unpacking the Manager</a></li><li><a href="#runtime-responsibilities" class="table-of-contents__link toc-highlight">Runtime Responsibilities</a></li></ul></li><li><a href="#using-combomanager" class="table-of-contents__link toc-highlight">Using <code>ComboManager</code></a><ul><li><a href="#public-interface" class="table-of-contents__link toc-highlight">Public Interface</a></li><li><a href="#sequence-diagram-player-input-to-finisher" class="table-of-contents__link toc-highlight">Sequence Diagram: Player Input to Finisher</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></li><li><a href="#runtime-examples" class="table-of-contents__link toc-highlight">Runtime Examples</a><ul><li><a href="#runtime-timeline-a-iceslash-cancelled-fireslash-finisher-triggered" class="table-of-contents__link toc-highlight">Runtime Timeline A: <em>“IceSlash Cancelled, FireSlash Finisher Triggered”</em></a></li><li><a href="#runtime-timeline-b-iceslash-completed-groundslam-finisher-triggered-fireslash-finisher-cancelled" class="table-of-contents__link toc-highlight">Runtime Timeline B: <em>“IceSlash Completed, GroundSlam Finisher Triggered, FireSlash Finisher Cancelled”</em></a></li></ul></li><li><a href="#preparing-the-animation-clip-and-setting-up-the-animator-fsm" class="table-of-contents__link toc-highlight">Preparing the Animation Clip and Setting up the Animator FSM</a><ul><li><a href="#step-1-create-clips-for-all-combat-movement-step-and-special-finisher-animation" class="table-of-contents__link toc-highlight">Step 1: Create clips for all combat movement step and special finisher animation</a></li><li><a href="#step-2-create-animator-fsm" class="table-of-contents__link toc-highlight">Step 2: Create Animator FSM</a></li></ul></li><li><a href="#demo" class="table-of-contents__link toc-highlight">Demo</a><ul><li><a href="#basic-single-tap-no-combo" class="table-of-contents__link toc-highlight">Basic Single Tap (no combo)</a></li><li><a href="#fireslash" class="table-of-contents__link toc-highlight">FireSlash</a></li><li><a href="#iceslash" class="table-of-contents__link toc-highlight">IceSlash</a></li><li><a href="#failed-iceslash" class="table-of-contents__link toc-highlight">Failed IceSlash</a></li><li><a href="#groundslam" class="table-of-contents__link toc-highlight">GroundSlam</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 50.033 Game Design and Development</div></div></div></footer></div>
</body>
</html>