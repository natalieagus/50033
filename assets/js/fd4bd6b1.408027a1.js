"use strict";(self.webpackChunksite_docusaurus_template=self.webpackChunksite_docusaurus_template||[]).push([[1930],{50460:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>p,default:()=>x,frontMatter:()=>h,metadata:()=>s,toc:()=>m});const s=JSON.parse('{"id":"children/static","title":"C# Quick Tour","description":"Quick Tour","source":"@site/docs/04-children/static.md","sourceDirName":"04-children","slug":"/children/static","permalink":"/50033/docs/children/static","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"The Singleton Pattern","permalink":"/50033/docs/children/singletons"},"next":{"title":"Scriptable Objects","permalink":"/50033/docs/children/scriptableobjects"}}');var r=t(74848),i=t(28453),a=(t(53398),t(19894)),o=t(88761),c=(t(89166),t(384)),l=t(72206),d=t(82223);const h={sidebar_position:2},p="C# Quick Tour",u={},m=[{value:"C# Static Variable",id:"c-static-variable",level:2},{value:"Utilise <code>static instance</code> with Singleton",id:"utilise-static-instance-with-singleton",level:3},{value:"Remove Mario and HUDManager Singleton",id:"remove-mario-and-hudmanager-singleton",level:3},{value:"Restart Button",id:"restart-button",level:3},{value:"Setting Score Upon Scene Change",id:"setting-score-upon-scene-change",level:3},{value:"C#: Interface",id:"c-interface",level:2},{value:"Interactive Button",id:"interactive-button",level:3},{value:"Powerups",id:"powerups",level:3},{value:"C#: Properties",id:"c-properties",level:2},{value:"C#: <code>enums</code>",id:"c-enums",level:2},{value:"C#: Abstract Class",id:"c-abstract-class",level:2},{value:"Abstract Keyword",id:"abstract-keyword",level:3},{value:"Virtual Keyword",id:"virtual-keyword",level:3},{value:"New Keyword",id:"new-keyword",level:3},{value:"<code>override</code> vs <code>new</code>",id:"override-vs-new",level:3},{value:"Implement Powerups",id:"implement-powerups",level:2},{value:"Important Notes",id:"important-notes",level:3}];function g(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"c-quick-tour",children:"C# Quick Tour"})}),"\n",(0,r.jsxs)(n.p,{children:["We shall refactor our existing game further so that it becomes more modular and maintainable, especially when we want to create multiple ",(0,r.jsx)(n.strong,{children:"scenes"})," (stages) in our game."]}),"\n",(0,r.jsx)(n.h2,{id:"c-static-variable",children:"C# Static Variable"}),"\n",(0,r.jsxs)(n.p,{children:["When a variable is declared as static, then a ",(0,r.jsx)(n.strong,{children:"single"})," copy of the variable is created and shared among all objects at the class level. Static variables are accessed with the ",(0,r.jsx)(n.strong,{children:"name"})," of the class, they do not require any instance for access. In the Singleton class, we define ",(0,r.jsx)(n.code,{children:"instance"})," getter and setter:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:"    private static T _instance;\n    public static T instance\n    {\n        get\n        {\n            return _instance;\n        }\n    }\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"utilise-static-instance-with-singleton",children:["Utilise ",(0,r.jsx)(n.code,{children:"static instance"})," with Singleton"]}),"\n",(0,r.jsx)(n.p,{children:"This allows any Singleton to be referenced directly by other scripts as such:"}),"\n",(0,r.jsxs)(l.A,{children:[(0,r.jsx)(d.A,{value:"1",label:"PlayerMovement.cs",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:'title="PlayerMovement.cs"',children:"\n    void Awake(){\n        // other instructions\n        //highlight-start\n        // subscribe to Game Restart event\n        GameManagerWeek4.instance.gameRestart.AddListener(GameRestart);\n        //highlight-end\n    }\n\n"})})}),(0,r.jsx)(d.A,{value:"2",label:"EnemyManager.cs",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:"    void Awake()\n    {\n        // other instructions\n        //highlight-start\n        GameManagerWeek4.instance.gameRestart.AddListener(GameRestart);\n    //highlight-end\n    }\n\n"})})}),(0,r.jsx)(d.A,{value:"3",label:"HUDManager.cs",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:"\n    void Awake()\n    {\n        // other instructions\n        //highlight-start\n        // subscribe to events\n        GameManagerWeek4.instance.gameStart.AddListener(GameStart);\n        GameManagerWeek4.instance.gameOver.AddListener(GameOver);\n        GameManagerWeek4.instance.gameRestart.AddListener(GameStart);\n        GameManagerWeek4.instance.scoreChange.AddListener(SetScore);\n        //highlight-end\n\n    }\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:["This way, we ",(0,r.jsx)("span",{className:"orange-bold",children:"remove"})," references to ",(0,r.jsx)(n.code,{children:"PlayerMovement"})," and ",(0,r.jsx)(n.code,{children:"EnemyManager"})," instance from ",(0,r.jsx)(n.code,{children:"GameManager"})," Singleton, going from here:"]}),"\n",(0,r.jsx)(o.A,{path:t(68470).A,widthPercentage:"100%"}),"\n",(0,r.jsx)(n.p,{children:"... to here:"}),"\n",(0,r.jsx)(o.A,{path:t(68514).A,widthPercentage:"100%"}),"\n",(0,r.jsxs)(n.admonition,{type:"caution",children:[(0,r.jsxs)(n.p,{children:["We need to ensure that GameManager Singleton is created ",(0,r.jsx)(n.em,{children:"before"})," we try to reference ",(0,r.jsx)(n.code,{children:"instance"})," in each ",(0,r.jsx)(n.code,{children:"Awake()"})," function via other scripts above. Ensure your order of execution prioritizes GameManager first:"]}),(0,r.jsx)(o.A,{path:t(55576).A,widthPercentage:"100%"})]}),"\n",(0,r.jsx)(n.h3,{id:"remove-mario-and-hudmanager-singleton",children:"Remove Mario and HUDManager Singleton"}),"\n",(0,r.jsxs)(n.p,{children:["We can then ",(0,r.jsx)("span",{className:"orange-bold",children:"only"})," put GameManager under ",(0,r.jsx)(n.code,{children:"DontDestroyOnLoad"}),", while the rest of the objects (Mario, Canvas, Enemies, etc) can remain normal (new instance per scene). A few housekeeping:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Ensure that Mario does ",(0,r.jsx)(n.strong,{children:"not"})," refer to GameManager instance on the scene, ",(0,r.jsx)("span",{className:"orange-bold",children:"all"})," references to ",(0,r.jsx)(n.code,{children:"GameManager"})," should be obtained via ",(0,r.jsx)(n.code,{children:"static instance"})," property."]}),"\n",(0,r.jsxs)(n.li,{children:["Ensure that ",(0,r.jsx)(n.code,{children:"GameManager"})," is a ",(0,r.jsx)(n.strong,{children:"root"})," GameObject, best if it does NOT have any children. You can easily make a mistake referring to GameManager's children who are not Singletons"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Don't forget to ",(0,r.jsx)("span",{className:"orange-bold",children:"remove"})," subscription to ",(0,r.jsx)(n.code,{children:"activeSceneChanged"})," in ",(0,r.jsx)(n.code,{children:"PlayerMovement.cs"}),' because your Mario will not need to "reset" its position anymore in the new scene.']}),"\n",(0,r.jsx)(n.h3,{id:"restart-button",children:"Restart Button"}),"\n",(0,r.jsxs)(n.p,{children:["Initially, the restart button is made to call ",(0,r.jsx)(n.code,{children:"GameRestart"})," function at that scene's GameManager instance."]}),"\n",(0,r.jsx)(o.A,{path:t(67093).A,widthPercentage:"100%"}),"\n",(0,r.jsxs)(n.p,{children:["You need to call ",(0,r.jsx)(n.code,{children:"GameRestart"})," via script instead. Create a new script called ",(0,r.jsx)(n.code,{children:"ButtonController.cs"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:'title="ButtonController.cs"',children:"    public void ButtonClick()\n    {\n        GameManagerWeek4.instance.GameRestart();\n    }\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Then attach the script to the restart button, and select the ",(0,r.jsx)(n.code,{children:"ButtonClick()"})," function as a callback."]}),"\n",(0,r.jsx)(o.A,{path:t(29530).A,widthPercentage:"100%"}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.p,{children:["If your button somehow is ",(0,r.jsx)(n.strong,{children:"not"})," Clickable in ",(0,r.jsx)(n.code,{children:"World-1-2"}),", remember to check if you have the ",(0,r.jsx)(n.code,{children:"EventSystem"})," enabled with the ",(0,r.jsx)(n.strong,{children:"new"})," InputSystem:"]}),(0,r.jsx)(o.A,{path:t(63468).A,widthPercentage:"100%"}),(0,r.jsx)(n.p,{children:"Typically this will be automatically created the moment you create any interactive UI GameObject."})]}),"\n",(0,r.jsx)(n.h3,{id:"setting-score-upon-scene-change",children:"Setting Score Upon Scene Change"}),"\n",(0,r.jsx)(n.p,{children:"You may not need to reset Mario's position anymore because you have a new Mario instance in World-1-2 that you have placed in the correct starting position. However, the GameManager must do some housekeeping:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Remove the HUD when scene changes, this used to be done at ",(0,r.jsx)(n.code,{children:"Start()"})," in GameManager"]}),"\n",(0,r.jsx)(n.li,{children:"Set the score to current score (from World-1-1)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The GameManager can now subscribe to ",(0,r.jsx)(n.code,{children:"activeSceneChanged"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:'title="GameManager.cs"',children:"using UnityEngine.SceneManagement;\n\n\n    void Start()\n    {\n\n        gameStart.Invoke();\n        Time.timeScale = 1.0f;\n        //highlight-start\n        // subscribe to scene manager scene change\n        SceneManager.activeSceneChanged += SceneSetup;\n        //highlight-end\n    }\n\n    public void SceneSetup(Scene current, Scene next)\n    {\n        gameStart.Invoke();\n        SetScore(score);\n    }\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If everything works right, you can then have ",(0,r.jsx)("span",{className:"orange-bold",children:"everything"})," (HUD, Mario, GameManager) in each World independently (for testing):"]}),"\n",(0,r.jsx)(c.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-4/singleton-static.mp4",widthPercentage:"100%"}),"\n",(0,r.jsxs)(n.admonition,{title:"Notable features",type:"note",children:[(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"World-1-1 works as per normal: score increase, Goomba respawn and death, coins, game restart must all work as usual"}),"\n",(0,r.jsx)(n.li,{children:"World-1-2 carries over scores from World-1-1 to demonstrate persistence"}),"\n",(0,r.jsx)(n.li,{children:"World-1-2 can be played independently for testing, restart and scoring works too"}),"\n",(0,r.jsxs)(n.li,{children:["Only GameManager is part of ",(0,r.jsx)(n.code,{children:"DontDestroyOnLoad"})]}),"\n",(0,r.jsxs)(n.li,{children:["There's no ",(0,r.jsx)(n.code,{children:"NullReferenceError"})," on the Console"]}),"\n",(0,r.jsx)(n.li,{children:"There's only one Goomba for demonstration purposes in World-1-2. We have not managed Green Goombas (underground) yet"}),"\n"]}),(0,r.jsx)(o.A,{path:t(13806).A,widthPercentage:"100%"})]}),"\n",(0,r.jsx)(n.h2,{id:"c-interface",children:"C#: Interface"}),"\n",(0,r.jsxs)(n.p,{children:["It is very common in a game to have various types of buttons, powerups, or enemies, but they should have common methods that will be called by other scripts such as ",(0,r.jsx)(n.code,{children:"cast"})," or ",(0,r.jsx)(n.code,{children:"consume"}),", or ",(0,r.jsx)(n.code,{children:"click"}),", etc. To do this more uniformly, we can utilise an interface. Interface members should be ",(0,r.jsx)("span",{className:"orange-bold",children:"public"})," by default (",(0,r.jsx)("span",{className:"orange-bold",children:"legacy"}),", see deep dive section below), because they\u2019re meant to define the public API of a type, hence the name ",(0,r.jsx)("span",{className:"orange-bold",children:"interface"}),": a contract meant to be use by other classes."]}),"\n",(0,r.jsxs)(a.A,{title:"Deep Dive: Actually, Not-So-Simple Interface (Anymore)",children:[(0,r.jsx)(n.p,{children:"The legacy definition of C# interface were:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"An interface only has declarations of methods, properties, indexers, and events."}),"\n",(0,r.jsx)(n.li,{children:"An interface has only public members and it cannot include private, protected, or internal members."}),"\n",(0,r.jsx)(n.li,{children:"An interface cannot contain fields."}),"\n"]}),(0,r.jsxs)(n.p,{children:["However, more and more features are added now for various ",(0,r.jsx)(n.a,{href:"https://jeremybytes.blogspot.com/2019/11/c-8-interfaces-public-private-and.html",children:(0,r.jsx)(n.strong,{children:"reasons"})}),". It was first introduced in C#8.0 in 2019, with the goal of being able to extend existing interface ",(0,r.jsx)(n.strong,{children:"without"})," breaking legacy or old libraries."]}),(0,r.jsxs)(n.p,{children:["The syntax for an interface is relaxed to permit modifiers on its members. The following are permitted: ",(0,r.jsx)(n.code,{children:"private"}),", ",(0,r.jsx)(n.code,{children:"protected"}),", ",(0,r.jsx)(n.code,{children:"internal"}),", ",(0,r.jsx)(n.code,{children:"public"}),", ",(0,r.jsx)(n.code,{children:"virtual"}),", ",(0,r.jsx)(n.code,{children:"abstract"}),", ",(0,r.jsx)(n.code,{children:"sealed"}),", ",(0,r.jsx)(n.code,{children:"static"}),", ",(0,r.jsx)(n.code,{children:"extern"}),", and ",(0,r.jsx)(n.code,{children:"partial"})," with certain requirements."]}),(0,r.jsxs)(n.p,{children:["For example: C# Interface members ",(0,r.jsx)(n.strong,{children:"can"})," be private but must have concrete (default) implementation, for the purpose of useful refactoring and organization of code used to implement the interface's public API. You can read more about C# interface ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-8.0/default-interface-methods",children:"default implementation of interface methods here"})}),"."]})]}),"\n",(0,r.jsx)(n.h3,{id:"interactive-button",children:"Interactive Button"}),"\n",(0,r.jsx)(n.p,{children:"Let's try to create one simple interface for all interactive buttons:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:'title="IInteractiveButton.cs"',children:"\npublic interface IInteractiveButton\n{\n    void ButtonClick();\n}\n\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["There's no need to declare ",(0,r.jsx)(n.code,{children:"public"})," in the methods"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Rename your ",(0,r.jsx)(n.code,{children:"ButtonController.cs"})," script into ",(0,r.jsx)(n.code,{children:"RestartButtonController.cs"}),", and create another ",(0,r.jsx)(n.code,{children:"PauseButtonController.cs"})," script to pause the game. Both controllers must inherit ",(0,r.jsx)(n.code,{children:"IInteractiveButton"})," interface:"]}),"\n",(0,r.jsxs)(l.A,{children:[(0,r.jsx)(d.A,{value:"1",label:"RestartButtonController.cs",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:'using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\n// later on, teach interface\npublic class RestartButtonController : MonoBehaviour, IInteractiveButton\n{\n    // implements the interface\n    public void ButtonClick()\n    {\n        Debug.Log("Onclick restart button");\n        GameManagerWeek4.instance.GameRestart();\n    }\n}\n\n'})})}),(0,r.jsx)(d.A,{value:"2",label:"PauseButtonController.cs",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:"\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing UnityEngine.UI;\n\npublic class PauseButtonController : MonoBehaviour, IInteractiveButton\n{\n    private bool isPaused = false;\n    public Sprite pauseIcon;\n    public Sprite playIcon;\n    private Image image;\n    // Start is called before the first frame update\n    void Start()\n    {\n        image = GetComponent<Image>();\n    }\n\n    // Update is called once per frame\n    void Update()\n    {\n\n    }\n\n    public void ButtonClick()\n    {\n        Time.timeScale = isPaused ? 1.0f : 0.0f;\n        isPaused = !isPaused;\n        if (isPaused)\n        {\n            image.sprite = playIcon;\n        }\n        else\n        {\n            image.sprite = pauseIcon;\n        }\n    }\n}\n\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:["An error will be raised if we do not implement ",(0,r.jsx)(n.code,{children:"ButtonClick"})," method:"]}),"\n",(0,r.jsx)(o.A,{path:t(71511).A,widthPercentage:"50%"}),"\n",(0,r.jsx)(n.h3,{id:"powerups",children:"Powerups"}),"\n",(0,r.jsxs)(n.p,{children:["In Super Mario Bros, there are a few ",(0,r.jsx)(n.a,{href:"https://www.mariowiki.com/World_1-1_(Super_Mario_Bros.)",children:"powerups"}),". Power-ups are unique items that give special abilities to characters that use them."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Magic Mushroom"}),": Upgrades Mario to Super Mario"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"1-up Mushroom"})," (green mushroom): Grants Mario extra life"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Starman"}),": Grants Mario invincibility for a period of time"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Coin"}),': Increases score (not exactly special abilities, but something to "interact" with)']}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The main idea is that no matter which powerup is being collected by the player, we ",(0,r.jsx)("span",{className:"orange-bold",children:"filtered"})," and invoke the right subscribers for ",(0,r.jsx)(n.em,{children:"that"})," powerup:"]}),"\n",(0,r.jsx)(o.A,{customClass:"invert-color",path:t(77139).A,widthPercentage:"100%"}),"\n",(0,r.jsxs)(n.p,{children:["Create a new script called ",(0,r.jsx)(n.code,{children:"IPowerup.cs"}),", where we can declare the following interfaces:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:'title="IPowerup.cs"',children:"using UnityEngine;\n\npublic interface IPowerup\n{\n    void DestroyPowerup();\n    void SpawnPowerup();\n    void ApplyPowerup(MonoBehaviour i);\n\n    PowerupType powerupType\n    {\n        get;\n    }\n\n    bool hasSpawned\n    {\n        get;\n    }\n}\n\n\npublic interface IPowerupApplicable\n{\n    public void RequestPowerupEffect(IPowerup i);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"c-properties",children:"C#: Properties"}),"\n",(0,r.jsx)(n.p,{children:"We can get (and set) C# properties to allow access control over class members. It's pretty straightforward to implement just like in any other programming language. This example explains itself:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:"//Member variables can be referred to as fields.\nprivate  int _healthPoints;\n\n//healthPoints is a basic property\npublic  int healthPoints {\n\tget {\n\t\t//Some other code\n\t\t// ...\n\t\treturn _healthPoints;\n\t}\n\tset {\n\t\t// Some other code, check etc\n\t\t// ...\n\t\t_healthPoints = value; // value is the amount passed by the setter\n\t}\n}\n\n// usage\nDebug.Log(player.healthPoints); // this will call instructions under get{}\nplayer.healthPoints += 20; // this will call instructions under set{}, where value is 20\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Optionally, you can have ",(0,r.jsx)(n.code,{children:"private set"})," instead of just ",(0,r.jsx)(n.code,{children:"set"})," to disallow other classes from setting that member."]}),"\n",(0,r.jsxs)(n.h2,{id:"c-enums",children:["C#: ",(0,r.jsx)(n.code,{children:"enums"})]}),"\n",(0,r.jsxs)(n.p,{children:["Right now we have four different types of powerups. Sure, we can use ",(0,r.jsx)(n.em,{children:"tags"}),", or object ",(0,r.jsx)(n.em,{children:"name"})," or some kind of pre-determined ",(0,r.jsx)(n.code,{children:"id"})," to ",(0,r.jsx)(n.em,{children:"name"})," each of them but we would benefit more if we use the ",(0,r.jsx)(n.code,{children:"enum"})," type as we can name them more intuitively."]}),"\n",(0,r.jsx)(n.admonition,{title:"enum type",type:"note",children:(0,r.jsxs)(n.p,{children:["An enumeration type (or enum type) is a ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/value-types",children:"value type"})," defined by a set of named constants of the underlying ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/integral-numeric-types",children:"integral numeric"})," type."]})}),"\n",(0,r.jsxs)(n.p,{children:["Add the following code to ",(0,r.jsx)(n.code,{children:"IPowerup.cs"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:"\npublic enum PowerupType\n{\n    Coin = 0,\n    MagicMushroom = 1,\n    OneUpMushroom = 2,\n    StarMan = 3\n}\n\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["If you wish, you can create two separate files: ",(0,r.jsx)(n.code,{children:"IPowerup.cs"})," and ",(0,r.jsx)(n.code,{children:"PowerupType.cs"})," to physically separate the two."]})}),"\n",(0,r.jsx)(n.h2,{id:"c-abstract-class",children:"C#: Abstract Class"}),"\n",(0,r.jsxs)(n.p,{children:["Apart from sharing the same interface, each of our powerups will also share certain similar ",(0,r.jsx)(n.strong,{children:"characteristics"})," (properties and protected methods, or interface implementation), for instance:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Properties: ",(0,r.jsx)(n.code,{children:"PowerupType type"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GetPowerupType()"})," has the same implementation no matter which Powerup implements it"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["We can create an ",(0,r.jsx)(n.strong,{children:"abstract"})," base class."]}),"\n",(0,r.jsxs)(n.admonition,{title:"Abstract Class",type:"note",children:[(0,r.jsxs)(n.p,{children:["In C#, an abstract class is a class that cannot be instantiated directly but serves as a ",(0,r.jsx)(n.strong,{children:"blueprint"})," for other classes. It's meant to be subclassed (derived) by other classes, which provide implementations for its abstract members (methods, properties, events, and indexers). It can contain both ",(0,r.jsx)(n.strong,{children:"abstract"})," or ",(0,r.jsx)(n.strong,{children:"concrete"})," members."]}),(0,r.jsx)(n.p,{children:"Abstract classes are useful for creating hierarchies of related classes while ensuring a consistent structure and behavior across those classes."})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:'title="BasePowerup.cs"',children:"using UnityEngine;\n\n\npublic abstract class BasePowerup : MonoBehaviour, IPowerup\n{\n    public PowerupType type;\n    public bool spawned = false;\n    protected bool consumed = false;\n    protected bool goRight = true;\n    protected Rigidbody2D rigidBody;\n\n    // base methods\n    protected virtual void Start(){\n        rigidBody = GetComponent<Rigidbody2D>();\n    }\n\n    // interface methods\n    // 1. concrete methods\n    public PowerupType powerupType\n    {\n        get // getter\n        {\n            return type;\n        }\n    }\n\n    public bool hasSpawned\n    {\n        get // getter\n        {\n            return spawned;\n        }\n    }\n\n    public void DestroyPowerup()\n    {\n        Destroy(this.gameObject);\n    }\n\n    // 2. abstract methods, must be implemented by derived classes\n    public abstract void SpawnPowerup();\n    public abstract void ApplyPowerup(MonoBehaviour i);\n}\n\n"})}),"\n",(0,r.jsxs)(n.p,{children:["We can typically add the ",(0,r.jsx)(n.code,{children:"abstract"})," or ",(0,r.jsx)(n.code,{children:"virtual"})," keywords on methods/properties/events etc in the base class."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Feel free to modify the above to your own usage. For instance, we added more methods to manage Game Restart event and manage Audio Source better."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"abstract-keyword",children:"Abstract Keyword"}),"\n",(0,r.jsxs)(n.p,{children:["Methods or properties with ",(0,r.jsx)(n.code,{children:"abstract"})," keywords indicate that the thing being modified has a ",(0,r.jsx)(n.em,{children:"missing"})," or ",(0,r.jsx)(n.em,{children:"incomplete"})," implementation. We are ",(0,r.jsx)("span",{className:"orange-bold",children:"supposed"})," to ",(0,r.jsx)(n.code,{children:"override"})," these methods in the derived classes (otherwise there will be errors)."]}),"\n",(0,r.jsx)(n.h3,{id:"virtual-keyword",children:"Virtual Keyword"}),"\n",(0,r.jsxs)(n.p,{children:["Methods or properties with ",(0,r.jsx)(n.code,{children:"virtual"})," keywords means that we ",(0,r.jsx)(n.em,{children:"can"})," modify this method or property, and allow for it to be ",(0,r.jsx)(n.strong,{children:"overridden"})," in a derived class. In other words, we ",(0,r.jsx)(n.em,{children:"may"})," ",(0,r.jsx)(n.code,{children:"override"})," virtual methods if we would like to modify or extend it. We can still call the base class' method using ",(0,r.jsx)(n.code,{children:"base.methodName()"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Both abstract and virtual method ",(0,r.jsx)("span",{className:"orange-bold",children:"cannot"})," be declared as ",(0,r.jsx)(n.code,{children:"private"})," because they're meant to be modified by the derived class. You need to use either the ",(0,r.jsx)(n.code,{children:"protected"})," or ",(0,r.jsx)(n.code,{children:"public"})," keyword, but the former makes more sense as ",(0,r.jsx)(n.code,{children:"public"})," methods should've been declared on the interface instead and implemented either in the base class or the derived class."]})}),"\n",(0,r.jsx)(n.h3,{id:"new-keyword",children:"New Keyword"}),"\n",(0,r.jsxs)(n.p,{children:["If your base class has implemented some concrete method and you would like to ",(0,r.jsx)("span",{className:"orange-bold",children:"hide"})," it in your derived classes (with completely new implementation), use the ",(0,r.jsx)(n.code,{children:"new"})," keyword in your method or property declaration."]}),"\n",(0,r.jsxs)(n.h3,{id:"override-vs-new",children:[(0,r.jsx)(n.code,{children:"override"})," vs ",(0,r.jsx)(n.code,{children:"new"})]}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsxs)(n.mdxAdmonitionTitle,{children:[(0,r.jsx)(n.code,{children:"override"})," vs ",(0,r.jsx)(n.code,{children:"new"})," Keyword"]}),(0,r.jsxs)(n.p,{children:["The override modifier ",(0,r.jsx)(n.strong,{children:"extends"})," the ",(0,r.jsx)(n.strong,{children:"base"})," class ",(0,r.jsx)(n.strong,{children:"virtual or abstract"})," method, and the new modifier ",(0,r.jsx)(n.strong,{children:"hides"})," an accessible base class method. At first glance, using concrete method implementation in the base class and calling ",(0,r.jsx)(n.code,{children:"new"})," in the derived class (then using ",(0,r.jsx)(n.code,{children:"base.someMethod()"})," to invoke the base class method too) might seem to have the same effect as using virtual method in the base class and overriding it in the derived class. However, this is not always quite the expected behavior."]}),(0,r.jsxs)(n.p,{children:["TL;DR: If you're expecting ",(0,r.jsx)(n.strong,{children:"standard"})," polymorphism behavior, use ",(0,r.jsx)(n.code,{children:"virtual"})," methods in base class and ",(0,r.jsx)(n.code,{children:"override"})," keyword in derived classes, and call ",(0,r.jsx)(n.code,{children:"base.methodName()"})," wherever appropriate."]}),(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/knowing-when-to-use-override-and-new-keywords",children:["Read more about when to use ",(0,r.jsx)(n.code,{children:"override"})," vs ",(0,r.jsx)(n.code,{children:"new"})," keyword here"]}),"."]})]}),"\n",(0,r.jsxs)(a.A,{children:[(0,r.jsxs)(n.p,{children:["The difference between the two is very apparent in this example, especially when we declare object type ",(0,r.jsx)(n.code,{children:"BaseClass"})," using ",(0,r.jsx)(n.code,{children:"DerivedClass"})," constructor. The output of line ",(0,r.jsx)(n.code,{children:"42"})," will be ",(0,r.jsx)(n.strong,{children:"different"})," to the output of line ",(0,r.jsx)(n.code,{children:"38"}),"."]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:"showLineNumbers",children:'using UnityEngine;\n\n\nclass BaseClass\n{\n    public virtual void Method1()\n    {\n        Debug.Log("Base - Method1");\n    }\n    public void Method2()\n    {\n        Debug.Log("Base - Method2");\n    }\n}\n\nclass DerivedClass : BaseClass\n{\n    public override void Method1()\n    {\n        base.Method1();\n        Debug.Log("Derived - Method1");\n    }\n    public new void Method2()\n    {\n        base.Method2();\n        Debug.Log("Derived - Method2");\n    }\n}\n\npublic class Playground : MonoBehaviour\n{\n    // Start is called before the first frame update\n    void Start()\n    {\n        // here, both methods behave similarly\n        DerivedClass dc = new DerivedClass();\n        dc.Method1();\n        dc.Method2();\n        // but here, these methods behave differently\n        //highlight-start\n        BaseClass bc = new DerivedClass();\n        bc.Method1();\n        bc.Method2();\n        //highlight-end\n    }\n\n    // Update is called once per frame\n    void Update()\n    {\n\n    }\n}\n'})}),(0,r.jsx)(n.p,{children:"The output is:"}),(0,r.jsx)(o.A,{path:t(57042).A,widthPercentage:"100%"}),(0,r.jsxs)(n.p,{children:["Notice how ",(0,r.jsx)(n.code,{children:"bc.Method2()"})," does ",(0,r.jsx)(n.strong,{children:"not"})," have any reference to ",(0,r.jsx)(n.code,{children:"DerivedClass"}),"' ",(0,r.jsx)(n.code,{children:"Method2"})," due to the ",(0,r.jsx)(n.code,{children:"new"})," implementation in the derived class."]})]}),"\n",(0,r.jsx)(n.h2,{id:"implement-powerups",children:"Implement Powerups"}),"\n",(0,r.jsxs)(n.p,{children:["We can now use the ",(0,r.jsx)(n.code,{children:"BasePowerup"})," class to create MagicMushroom powerup and we want to ",(0,r.jsx)(n.strong,{children:"extend"})," ",(0,r.jsx)(n.code,{children:"Start()"})," virtual method in MagicMushroomPowerup."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",metastring:'title="MagicMushroomPowerup.cs"',children:'\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class MagicMushroomPowerup : BasePowerup\n{\n    // setup this object\'s type\n    // instantiate variables\n    protected override void Start()\n    {\n        base.Start(); // call base class Start()\n        this.type = PowerupType.MagicMushroom;\n    }\n\n    void OnCollisionEnter2D(Collision2D col)\n    {\n        if (col.gameObject.CompareTag("Player") && spawned)\n        {\n            // TODO: do something when colliding with Player\n\n            // then destroy powerup (optional)\n            DestroyPowerup();\n\n        }\n        else if (col.gameObject.layer == 10) // else if hitting Pipe, flip travel direction\n        {\n            if (spawned)\n            {\n                goRight = !goRight;\n                rigidBody.AddForce(Vector2.right * 3 * (goRight ? 1 : -1), ForceMode2D.Impulse);\n\n            }\n        }\n    }\n\n    // interface implementation\n    public override void SpawnPowerup()\n    {\n        spawned = true;\n        rigidBody.AddForce(Vector2.right * 3, ForceMode2D.Impulse); // move to the right\n    }\n\n\n    // interface implementation\n    public override void ApplyPowerup(MonoBehaviour i)\n    {\n        // TODO: do something with the object\n\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"The question box that spawned the Magic Mushroom must be set into some kind of disabled state after the mushroom is spawned. You can create a simple controller for that:"}),"\n",(0,r.jsxs)(l.A,{children:[(0,r.jsx)(d.A,{value:"1",label:"IPowerupController.cs",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:"public interface IPowerupController\n{\n    void Disable();\n}\n\n"})})}),(0,r.jsx)(d.A,{value:"2",label:"QuestionBoxPowerupController.cs",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cs",children:'using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class QuestionBoxPowerupController : MonoBehaviour, IPowerupController\n{\n    public Animator powerupAnimator;\n    public BasePowerup powerup; // reference to this question box\'s powerup\n\n    void Start()\n    {\n\n    }\n\n    // Update is called once per frame\n    void Update()\n    {\n\n    }\n\n\n    private void OnCollisionEnter2D(Collision2D other)\n    {\n        if (other.gameObject.tag == "Player" && !powerup.hasSpawned)\n        {\n            // show disabled sprite\n            this.GetComponent<Animator>().SetTrigger("spawned");\n            // spawn the powerup\n            powerupAnimator.SetTrigger("spawned");\n        }\n    }\n\n    // used by animator\n    public void Disable()\n    {\n        this.GetComponent<Rigidbody2D>().bodyType = RigidbodyType2D.Static;\n        transform.localPosition = new Vector3(0, 0, 0);\n    }\n\n\n\n}\n'})})})]}),"\n",(0,r.jsx)(n.p,{children:"Then create a simple prefab extending the bouncy question box you did in the earlier week. There are many ways to implement this prefab, here's one sample:"}),"\n",(0,r.jsx)(c.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-4/setup-magic-mushroom.mp4",widthPercentage:"100%"}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.p,{children:["While the above implementation seems working at first glance, there exist one particular bug. We will fix this ",(0,r.jsx)(n.a,{href:"/50033/docs/children/coroutines#powerup-bug",children:"later"})," since we are not equipped for it yet."]})}),"\n",(0,r.jsx)(n.h3,{id:"important-notes",children:"Important Notes"}),"\n",(0,r.jsxs)(n.p,{children:["Note that methods that are declared on the interface are meant to be ",(0,r.jsx)(n.strong,{children:"public"}),": used by other instances."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"SpawnPowerup"})," might be called by Animators or events"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ApplyPowerup"})," might be called by some PowerupManager or instances that consumes the powerup"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"DestroyPowerup"})," might be called after some timeout"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"On the contrary, if you have some methods that are meant to be extended within the powerup only, then these methods should be declared in the BaseClass instead (either as abstract, virtual, or concrete methods)."}),"\n",(0,r.jsxs)(n.admonition,{type:"playtest",children:[(0,r.jsxs)(n.p,{children:["Refactor your Coin box to implement ",(0,r.jsx)(n.code,{children:"Powerup"})," and inherit ",(0,r.jsx)(n.code,{children:"BasePowerup"})," as well so you can have similar functionalities. You can begin by creating ",(0,r.jsx)(n.code,{children:"BrickPowerupController.cs"})," which implements ",(0,r.jsx)(n.code,{children:"IPowerupController"})," interface, because how a brick is controlled is eventually different from the question box (brick is ",(0,r.jsx)(n.em,{children:"breakable"})," by SuperMario). Here's an example where we can dynamically set whether the coin brick is eventually breakable (by SuperMario) or not:"]}),(0,r.jsx)(c.A,{path:"https://50033.s3.ap-southeast-1.amazonaws.com/week-4/powerup-coin.mp4",widthPercentage:"100%"})]})]})}function x(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(g,{...e})}):g(e)}},68470:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-24-11-52-07-20d87544bd7ea23a8d350831c6b022ea.png"},68514:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-24-12-02-34-79596a0c74c43f6b49fe3b18d5d1ea78.png"},67093:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-24-13-39-56-2eb94dfe7a1c100ea90455aeb38a9ba4.png"},29530:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-24-13-42-53-3d172457fd9d7c6eedd6adbe79c8bc62.png"},63468:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-24-13-44-04-a83913467a8603707b652795997fb0b4.png"},55576:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-24-14-02-56-778014739886ace60483dd42b74bc45c.png"},13806:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-24-14-16-55-fef49c7c53a6c769eee65159379a390f.png"},71511:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-25-10-42-12-192a3b6d6cf3632ef54577f8a31b2846.png"},57042:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/2023-08-29-10-40-05-3a47b6f27d97f81aa3ba49e8fe191c0f.png"},77139:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/50033-2023.drawio-55546dc6bd7a47e6fecc8dd74cbc35ce.png"}}]);